#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usetheme{CambridgeUS}
\usecolortheme{dolphin}
\hypersetup{pdfpagemode=None}
\usepackage{tikz}
\usepackage{color}
\usepackage{listings}

% This allows to change color of symbols in math
\newcommand*{\mathcolor}{}
\def\mathcolor#1#{\mathcoloraux{#1}}
\newcommand*{\mathcoloraux}[3]{%
  \protect\leavevmode
  \begingroup
    \color#1{#2}#3%
  \endgroup
}

% new counter for exercises
\newcounter{ctEx}
\setcounter{ctEx}{0}
\newcommand{\exercise}[1]{
\refstepcounter{ctEx}\label{#1}
\arabic{ctEx}
}
%\newcommand{\exercise}{
%  \addtocounter{ctEx}{1}
%  \arabic{ctEx}
%}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 0
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch Deleted
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 2
\tocdepth 2
\paragraph_separation skip
\defskip medskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
\begin_inset Argument 1
status open

\begin_layout Plain Layout
OceMod
\end_layout

\end_inset

Introduction to Numerical Ocean Modelling
\end_layout

\begin_layout Author
Marcello Vichi
\end_layout

\begin_layout Institute
\begin_inset Argument 1
status open

\begin_layout Plain Layout
UCT
\end_layout

\end_inset

Department of Oceanography
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

University of Cape Town
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

marcello.vichi@uct.ac.za
\end_layout

\begin_layout Date
Honours
\end_layout

\begin_layout Section*
Outline
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Course plan
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
This course is structured in sections and it is designed with an intensive
 full-time schedule (frontal lectures in bold)
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Day
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Morning
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Afternoon
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Sec.
 1; Sec.
 2 (3 exercises)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Sec.
 3 (2 ex.); Sec.
 4 (2 ex.)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Study and exercises
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
zoom meeting (optional)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Corrections (individually graded)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Sec.
 5 (2 ex); Sec.
 6.1 (1 ex.) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Study and exercises
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
zoom meeting (optional)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Corrections; Sec.
 6.2, 6.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
zoom meeting (optional)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
w-e
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Study and exercises
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Corrections (individually graded)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
Sec.
 7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
7-14
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Team project; Project presentation (frontal/zoom)
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The exercises will need to be completed and submitted on VULA before the
 starting of the next section
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Outline
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\end_deeper
\begin_layout Section
Mathematical and numerical modelling
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Describing and predicting changes in the ocean
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Fact
The areas of mathematics which are critical to the description of changing
 processes are 
\begin_inset Flex Bold
status open

\begin_layout Plain Layout
calculus
\end_layout

\end_inset

 and 
\series bold
differential equations
\series default

\begin_inset Foot
status open

\begin_layout Plain Layout
For an accurate definition of mathematical terms see http://mathworld.wolfram.com/
 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Calculus (also analysis) is the branch of mathematics that studies variables,
 functions and their rate of change, as well as length, area and volume
 of objects
\end_layout

\begin_layout Itemize
Differential equations (ordinary differential equations, ODE) and partial
 differential equations (PDE) are used to describe quantities that change
 continuously in time and space 
\end_layout

\begin_layout Itemize
All areas of oceanography rely heavily on these subjects to describe the
 physical, chemical and biological processes.
 But obtaining practical solutions is another thing...
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Mathematical modelling of ocean systems
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Definition

\size small
\begin_inset Argument 2
status open

\begin_layout Plain Layout

\end_layout

\end_inset

Mathematical modelling is the process of defining 
\series bold
relevant system state variables
\series default
 and constructing appropriate 
\series bold
relationships
\series default
 between them to represent 
\series bold
determined features
\series default
 of a system 
\end_layout

\begin_layout Itemize

\size footnotesize
The state variables can be described by means of 
\series bold
continuous
\series default
 or 
\series bold
discrete
\series default
 quantities.
 Ocean temperature and the concentration of dissolved carbon can be treated
 as continuous variables (owing to the nature of the fluid).
 Higher trophic levels are better described with discrete quantities.
 All living organisms are discrete, although continuous approximation are
 often justifiable
\end_layout

\begin_layout Itemize

\size footnotesize
Models can be 
\series bold
dynamical
\series default
 or 
\series bold
empirical
\series default
 (statistical).
 This course introduces dynamical models based on continuous state variables
 
\end_layout

\begin_layout Itemize

\size footnotesize
Dynamical modelling includes the various methods to build the equations,
 to obtain exact and approximate solutions, and to perform simulations
\end_layout

\begin_layout Definition

\size small
\begin_inset Argument 2
status open

\begin_layout Plain Layout

\end_layout

\end_inset

A 
\series bold
dynamical mathematical model
\series default
 is a set of differential equations that describe the evolution of a system
 in time and/or space.
 It can be solved analytically and/or numerically
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Numerical modelling in ocean sciences
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
All processes in oceanography are dynamical, that is they change both in
 time and space
\end_layout

\begin_layout Itemize

\size small
Finding the time evolution and space distribution of a property requires
 solving (
\emph on
integrating
\emph default
) systems of differential equations
\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize

\size small
This process is done by creating numerical 
\series bold
discretized
\series default
 forms of the continuous equations that can be solved with a computer code
 written with a suitable programming language
\end_layout

\begin_layout Itemize

\size small
The model is integrated in different ways:
\end_layout

\begin_deeper
\begin_layout Itemize

\size small
hindcast mode
\end_layout

\begin_layout Itemize

\size small
forecast mode
\end_layout

\begin_layout Itemize

\size small
scenario mode
\end_layout

\end_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/digital-earth.jpg
	width 4cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Models based on ODE
\begin_inset CommandInset label
LatexCommand label
name "sec:Models-based-on"

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Ordinary Differential Equations (ODE)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Definition
ODEs are mathematical objects useful to describe changes in time or in space
 because they are based on one single independent variable
\begin_inset Formula 
\[
\frac{dC}{dt}=f\left(C,t,\mathsf{constants}\right);\ \frac{dM}{dx}=f\left(M,x,\mathsf{constants}\right)
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
\begin_inset Formula $t$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

 are the independent variables.
 The functions 
\begin_inset Formula $C(t)$
\end_inset

 and 
\begin_inset Formula $M(x)$
\end_inset

 are the solutions of the differential equations.
 Type of ODEs:
\size default

\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\size small
Initial value problem, 0-dimensional (time)
\series default
: this model describes the time evolution of a variable (sea surface height,
 phytoplankton population, etc.).
 The solution is the (continuous) time series of the variable values, starting
 from an 
\emph on
initial condition
\emph default
 
\begin_inset Formula $C(t=0)$
\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
\size small
Boundary value problem, 1-dimensional (space)
\series default
: the Lambert-Beer equation is an example of 1-D spatial ODE because it
 describes the change with depth of the light distribution.
 The solution is a spatial function (in this case a profile).
 Spatial ODEs need a 
\emph on
boundary condition
\emph default
 
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Malthusian growth model
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The derivation of the Malthusian model is based on the concept that the
 growth rate is proportional to the population.
 The independent variable is time and there is an increase of population
 with time that is expressed as 
\begin_inset Formula 
\[
\Delta N=\mu N\Delta t
\]

\end_inset

where the growth rate 
\begin_inset Formula $\mu$
\end_inset

 is in units of 1/time.
\end_layout

\begin_layout Itemize
We put this equation in differential form and obtain what is called the
 dynamics of the exponential growth model 
\begin_inset Formula 
\begin{equation}
\frac{dN}{dt}=\mu N\label{eq:malthus}
\end{equation}

\end_inset

which can be solved analytically by separating the variables, integrating
 the two sides and applying an initial condition 
\begin_inset Formula $N(t=0)=N_{0}$
\end_inset


\begin_inset Formula 
\[
\int\frac{1}{N}dN=\mu\int dt\Rightarrow N=N_{0}e^{\mu t}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Light attenuation: the Lambert-beer equation
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\begin_layout Itemize

\size small
Light is attenuated of a certain fraction along its pathway through any
 medium, which is characterized by the constant attenuation coefficient
 
\begin_inset Formula $\varepsilon$
\end_inset

 (units are 1/length)
\end_layout

\begin_layout Itemize
\begin_inset Formula 
\[
I_{1}=I_{0}-\varepsilon I_{0}\ell\Rightarrow\Delta I=-\varepsilon I\Delta x
\]

\end_inset


\end_layout

\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/lambert-beer.jpg
	lyxscale 60
	scale 60

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
By putting it in differential form, one obtains the Lambert-Beer equation
\begin_inset Formula 
\begin{equation}
\frac{dI}{dx}=-\varepsilon I\label{eq:decay}
\end{equation}

\end_inset

which can be solved analytically by separating the variables, integrating
 the two sides and applying the boundary condition 
\begin_inset Formula $I(x=0)=I_{0}$
\end_inset


\begin_inset Formula 
\[
\int\frac{1}{I}dI=-\varepsilon\int dx\Rightarrow I=I_{0}e^{-\varepsilon x}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Useful ODE features to remember
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size scriptsize
the 
\series bold
order
\series default
 is the value of the highest-order derivative
\begin_inset Formula 
\[
\frac{dC}{dt}=\lambda C^{3}-C^{2}+a_{0}\ \left(\mathsf{1st}\right);\ \frac{d^{2}C}{dx^{2}}=\mu\frac{dC}{dx}-C\ \left(\mathsf{2nd}\right)
\]

\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
a 
\series bold
homogeneous
\series default
 (or autonomous) ODE has only terms containing the dependent variable or
 its derivative 
\begin_inset Formula $\frac{dC}{dt}=-\lambda C$
\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
a 
\series bold
non-homogeneous
\series default
 (or non-autonomous) ODE contains additional terms, such as a constant or
 the independent variable itself
\begin_inset Formula 
\[
a_{2}\frac{d^{2}C}{dx^{2}}+a_{1}\frac{dC}{dx}-a_{0}C=x^{2}
\]

\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
a 
\series bold
linear
\series default
 ODE only contains linear terms, like the decay equation or population growth.
 If one term is added to represent higher-order terms such as for instance
 quadratic mortality as in the example below, 
\begin_inset Formula 
\[
\frac{dP}{dt}=\mu P-mP^{2}
\]

\end_inset

then the ODE becomes 
\series bold
non-linear
\series default
.
 Most of the non-linear ODEs are solved numerically
\end_layout

\begin_layout Itemize

\series bold
\size scriptsize
initial value problems
\series default
 have a starting point 
\begin_inset Formula $C(t=t_{0})$
\end_inset

 and are 
\emph on
integrated
\emph default
 forward in time to obtain 
\begin_inset Formula $C(t)$
\end_inset

 (for all) 
\begin_inset Formula $\forall t>t_{0}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\size scriptsize
boundary value problems
\series default
 seek the solution 
\begin_inset Formula $C(x)$
\end_inset

 over a certain domain given specific values at the beginning and end of
 the domain or also within the domain itself
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:flynn}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Phytoplankton growth follows an exponential phase, at least for a certain
 period of time until resources may become limiting or other factors control
 the Malthusian growth
\end_layout

\begin_layout Itemize

\size small
The file 
\family typewriter
flynn94.csv
\family default
 contains data from a batch experiment conducted by Flynn et al.
 (1994).
 The full table and the related units are available in file 
\family typewriter
flynn94.pdf
\family default
.
 
\emph on
Flynn, K.J., Davidson, K., Leftley, J.W., 1994.
 Carbon-nitrogen relations at whole-cell and free-amino-acid levels during
 batch growth of Isochrysis galbana (Prymnesiophyceae) under conditions
 of alternating light and dark.
 Marine Biology 118, 229–237.
 https://doi.org/10.1007/BF00349789
\end_layout

\begin_layout Itemize

\size small
Plot the data using a software of your choice and answer the following questions
\end_layout

\begin_deeper
\begin_layout Enumerate

\size small
Is the growth exponential? 
\end_layout

\begin_layout Enumerate

\size small
Can you separate the growth curve into some phases?
\end_layout

\begin_layout Enumerate

\size small
How different is the growth expressed in cellular carbon from the one in
 cell number and chlorophyll?
\end_layout

\begin_layout Enumerate

\size small
Is the ammonium consumption approximated by an exponential curve?
\end_layout

\begin_layout Enumerate

\size small
How would you estimate the parameters of the growth curve?
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Ocean systems that can be described with multiple ODEs
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Definition
A system of (coupled) ODEs is a combination of ODE equations where the state
 variables interact with each other.
 
\end_layout

\begin_layout Standard
This is an initial value problem.
 We know the initial state of the system and want to determine the time
 evolution of the state variables
\end_layout

\begin_layout Itemize

\size small
A (biogeo)chemical system with multiple reactions (
\begin_inset Formula $A+B\Rightarrow C+D$
\end_inset

) 
\end_layout

\begin_layout Itemize

\size small
A system with prey-predator interactions (a trophic web, like primary producers
 and grazers)
\end_layout

\begin_layout Itemize

\size small
A physiological model describing biochemical transformations (the carbon
 biomass formation through photosynthesis driven by light availability)
\end_layout

\begin_layout Standard
These models are usually called 
\series bold
box models
\series default
: they are characterized by the dynamical co-existence of the state variables
 in the same enclosure.
 
\series bold
Very important:
\series default
 exchanges with the region(s) outside the system are known or negligible
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Initial value problems in biology/biogeochemistry
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/substrate.png
	lyxscale 50
	scale 30

\end_inset


\end_layout

\begin_layout Standard

\size scriptsize
A simple chemical reaction model where the substrate is transformed into
 a product: 
\begin_inset Formula $\mathrm{substrate\stackrel{k}{\Longrightarrow}}\mathrm{product}$
\end_inset


\end_layout

\begin_layout Standard

\size scriptsize
It is based on the concept that the 
\series bold
transformation rate is proportional to the chemical equilibrium constant
 and to the concentration of the substrate
\series default
.
 The equations are a direct consequence of the mass conservation principle:
 the rate of change of the substrate is equal and opposite to the rate of
 change of the product:
\begin_inset Formula 
\begin{equation}
\frac{dS}{dt}+\frac{dP}{dt}=\frac{d\left(S+P\right)}{dt}=0\label{eq:mass_conservation}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size scriptsize
It is described by a system of 2 variables 
\begin_inset Formula $S(t)$
\end_inset

, 
\begin_inset Formula $P(t)$
\end_inset

 and 2 ODEs
\begin_inset Formula 
\begin{align*}
\frac{dS}{dt}= & -kS\\
\frac{dP}{dt}= & kS
\end{align*}

\end_inset

where the first one is the decay equation and the second one is Malthusian
 growth.
 Any initial value problem needs 
\series bold
initial conditions
\series default
, 
\begin_inset Formula $S(t=0)=S_{0}$
\end_inset

, 
\begin_inset Formula $P(t=0)=P_{0}$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Analytical solutions
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Some ODEs like the decay or Malthusian growth can be integrated by separation
 of variables (see the Malthusian equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:malthus"
plural "false"
caps "false"
noprefix "false"

\end_inset

); other ODEs can be solved by substitution of variables, or trigonometric
 equations.
 All the ODEs that can be analytically solved are tabulated (best reference:
 CRC Standard Mathematical Tables, Zwillinger, 2002).
 The first equation is solved and then the solution goes into the second
 equation which is again solved by separation of variables with the application
 of the initial condition 
\begin_inset Formula 
\begin{align*}
S(t)= & S_{0}e^{-kt}\\
\frac{dP}{dt}= & kS_{0}e^{-kt}\\
P(t)= & P_{0}-S_{0}e^{-kt}
\end{align*}

\end_inset

Note that due to eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mass_conservation"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset Formula $P+S=P_{0}+S_{0}$
\end_inset

 for every 
\begin_inset Formula $t$
\end_inset

 
\begin_inset Formula $\left(\forall t\right)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Resource and consumer
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/resource-consumer.png
	lyxscale 50
	scale 40

\end_inset


\end_layout

\begin_layout Standard
\noindent

\size scriptsize
Let's analyse a system with one resource and one consumer (e.g.
 phytoplankton and one dissolved nutrient like ammonium).
 If we assume that the rate of change of the resource is 
\series bold
only controlled by the consumer
\series default
 (as in the previous case) according to the uptake rate and the abundance
 we write: 
\begin_inset Formula 
\[
\frac{dN}{dt}=-kP
\]

\end_inset

But then the application of mass conservation gives 
\begin_inset Formula 
\[
\frac{d\left(P+N\right)}{dt}=0\longrightarrow\frac{dP}{dt}=kP
\]

\end_inset

which is the infinite Malthusian growth that by definition is not resource-limit
ed.
 
\series bold
This set of ODE does not work to model this system
\series default
 because the
\series bold
 resource should also control the consumption rate
\series default
 (see the different shape of the arrow in the graph, which means dependence,
 as opposed to a normal arrow that indicates direct relationship)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Limits to growth
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
7cm
\end_layout

\begin_layout Itemize

\size small
Growth with limited resources is by definition a non-linear model and we
 need to adjust the functional form of the equation and include a new parameters
 that has not only units 
\begin_inset Quotes eld
\end_inset

per time
\begin_inset Quotes erd
\end_inset

 but also 
\begin_inset Quotes eld
\end_inset

per concentration
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/limits-growth-NP.png
	width 6cm

\end_inset


\end_layout

\begin_layout Column
5cm
\end_layout

\begin_layout Standard

\size small
\begin_inset Formula 
\begin{align}
k= & k'N\nonumber \\
\frac{dN}{dt}= & -k'NP\label{eq:limited_growth}\\
\frac{dP}{dt}= & k'NP\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Itemize

\size small
In this case the consumer growth is limited by the resource.
 This system has the analytical solution
\begin_inset Formula 
\begin{align*}
P+N= & P_{0}+N_{0}\\
P(t)= & P_{0}\frac{P_{0}+N_{0}}{P_{0}+N_{0}e^{k'\left(P_{0}+N_{0}\right)t}}
\end{align*}

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:limited_growth}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Using a software of your choice, plot the analytical solution of the model
 presented in eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:limited_growth"
plural "false"
caps "false"
noprefix "false"

\end_inset

) to show the time evolution of phytoplankton and nutrient concentrations.
 Use the following parameters:
\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Time axis in days, from 0 to 20 days
\end_layout

\begin_layout Itemize

\size small
\begin_inset Formula $k'=0.1$
\end_inset

 d
\begin_inset Formula $^{-1}$
\end_inset

; 
\begin_inset Formula $P_{0}=0.1$
\end_inset

 mmol N m
\begin_inset Formula $^{-3}$
\end_inset

 and 
\begin_inset Formula $P_{0}=5$
\end_inset

 mmol N m
\begin_inset Formula $^{-3}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize

\size small
Answer the following questions (adding plots where needed)
\end_layout

\begin_deeper
\begin_layout Enumerate

\size small
Why are the curves identical in shape?
\end_layout

\begin_layout Enumerate

\size small
What happens when you change the value of the uptake parameter? Think about
 it as the percentage of food consumed per day.
 
\end_layout

\begin_layout Enumerate

\size small
What happens if the initial biomass of phytoplankton is close to the amount
 of resource available? How does the shape of the curve change?
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
More complex models
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Model building is a delicate process, which takes different nuances depending
 on the group of people doing it and the specific discipline
\end_layout

\begin_layout Itemize
There is no 
\emph on
one-size-fits-all
\emph default
 or universal recipe for building a model that describes a certain aspect
 of the marine environment
\end_layout

\begin_layout Itemize
A useful introduction is given by Glover et al.
 (2011) in their Chapter 9 (available in the document folder).
 We will use their example 9.3 to explore the prey-predator interactions
 with the Lotka-Volterra model 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The Lotka-Volterra model
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Volterra (1926), the founder of the Italian National Council of Research,
 wanted to study prey-predator interactions in fish population; Lotka (1920;1925
) studied chemical oscillations between reagents and products
\end_layout

\begin_layout Itemize
The model describes the interaction between two populations.
 The prey 
\begin_inset Formula $X_{1}$
\end_inset

 grows following the Malthusian equation and is consumed by the predator
 
\begin_inset Formula $X_{2}$
\end_inset

 similarly to the resource-consumer model.
 The latter dies according to a constant decay term:
\begin_inset Formula 
\begin{align*}
\frac{dX_{1}}{dt} & =X_{1}\left(p_{1}-p_{2}X_{2}\right)\\
\frac{dX_{2}}{dt} & =X_{2}\left(p_{2}p_{3}X_{1}-p_{4}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
The presence of the parameter 
\begin_inset Formula $p_{3}$
\end_inset

 implies that there is no mass conservation, because the predator is not
 efficient in translating the ingestion rate into growth.
 Some mass from the prey is lost to the environment
\end_layout

\begin_layout Itemize

\series bold
Please note that this not a realistic model: it has major assumptions
\series default
 (
\bar under
read more about them in the textbook chapter
\bar default
): 1) The prey population is not resource limited.
 2) The food supply of the predator population depends entirely on the prey
 populations.
 3) The predator mortality is proportional to the population size.
 4) The environment does not change as well as the type of preys and predators.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Model description (from Glover et al 2011)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/LV-scheme.jpg
	lyxscale 50
	scale 80

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
A numerical solution from Glover et al (2011)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/ftut_LVpzts1.eps
	scale 50

\end_inset


\end_layout

\begin_layout Standard
The LV model is nowadays used mostly for educational purposes, because it
 allows a rigorous analysis to illustrate the major aspects of mathematical
 biology and it is a tractable example of numerical solution of ODE systems.
 Moreover, it does contain elements that are common to any marine model.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:LV}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
The L-V model cannot be solved analytically.
 Section 9.3.6 in the textbook above gives an example of a MATLAB computer
 code to resolve numerically the system of equations.
 This code is available in the python notebook
\family typewriter
 LV_pz.ipynb
\family default
.
 It uses an ODE solver that we will understand more in detail 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:Numerical-time-integration"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Run the code to reproduce the panel a from the previous figure
\end_layout

\begin_layout Itemize

\size small
Answer the following questions
\end_layout

\begin_deeper
\begin_layout Enumerate

\size small
Write the code to plot panel b in the appropriate cell block
\end_layout

\begin_layout Enumerate

\size small
Set the parameter 
\begin_inset Formula $p_{3}=1$
\end_inset

 and compare how different the trajectory is in the phase space
\end_layout

\begin_layout Enumerate

\size small
Write the code to compute the solution of the L-V model using the initial
 conditions given in the caption of Fig.
 9.4 in the Glover at al textbook and plot the results
\end_layout

\begin_layout Enumerate

\size small
Why are they different? Think about a few hypotheses and then see the explanatio
n in the document 
\family typewriter
Glover_etal_2011_ERRATA.pdf
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Numerical methods
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Numerical methods
\begin_inset CommandInset label
LatexCommand label
name "fr:Numerical-methods"

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Approximation of functions
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
We need to specify a method by which a continuous function of one or more
 space dimensions and/or time can be represented in discrete form (finite
 number of unknown terms).
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Approximation of equations
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color black
Having chosen the discrete representation of functions, we need to adopt
 a way of discretizing and solving the particular equations that the functions
 must satisfy.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Taylor series
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Definition
Any function can be described by a series expansion about a fixed point
 
\begin_inset Formula $x_{0}$
\end_inset


\begin_inset Formula 
\begin{align}
f\left(x\right) & =f\left(x_{0}\right)+f\prime\left(x_{0}\right)\left(x-x_{0}\right)+\frac{f^{\prime\prime}\left(x_{0}\right)\left(x-x_{0}\right)^{2}}{2!}+\frac{f^{(3)}\left(x_{0}\right)\left(x-x_{0}\right)^{3}}{3!}+\cdots\nonumber \\
 & =f\left(x_{0}\right)+\sum_{n=1}^{\infty}\frac{f^{(n)}\left(x_{0}\right)\left(x-x_{0}\right)^{n}}{n!}\label{eq:Taylor-series}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
(
\begin_inset Formula $2!=2\times1$
\end_inset

 ; 
\begin_inset Formula $3!=3\times2\times1$
\end_inset

)The Taylor series expansion is used in ocean and atmosphere sciences to
 find linear solutions to non-linear dynamical equations.
 It is also used to derive numerical integration techniques as we will see
 soon .
\end_layout

\begin_layout Standard
The higher order derivatives of 
\begin_inset Formula $f(x)$
\end_inset

 are equivalent to writing 
\begin_inset Formula 
\[
f'=\frac{df}{dx};\ f''=\frac{d^{2}f}{dx^{2}};\cdots
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Taylor series as the foundation of finite differences
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The Taylor expansion is useful to know the error we make if we neglect the
 terms with higher order derivatives
\begin_inset Formula 
\[
f\left(x\right)\approx f\left(x_{0}\right)+f\prime\left(x_{0}\right)\left(x-x_{0}\right)+\mathcal{O}\left(\left(x-x_{0}\right)^{2}\right)
\]

\end_inset


\begin_inset Formula 
\begin{align*}
f\left(x\right)\approx & f\left(x_{0}\right)+f\prime\left(x_{0}\right)\left(x-x_{0}\right)+\frac{f^{\prime\prime}\left(x_{0}\right)\left(x-x_{0}\right)^{2}}{2!}+\\
 & +\frac{f^{(3)}\left(x_{0}\right)\left(x-x_{0}\right)^{3}}{3!}+\mathcal{O}\left(\left(x-x_{0}\right)^{4}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
The symbol 
\begin_inset Formula $\mathcal{O}\left(\left(x-x_{0}\right)^{k}\right)$
\end_inset

 indicates the order of magnitude 
\begin_inset Formula $k$
\end_inset

 of the error.
 Since we are considering to operate in the close vicinity of the fixed
 point, we usually have 
\begin_inset Formula $\left(x-x_{0}\right)\ll1$
\end_inset

 and the error decays geometrically
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:taylor}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Write the Taylor series expansion for the following univariate functions
 
\begin_inset Formula $f(x)$
\end_inset

 about the point 
\begin_inset Formula $x=x_{0}$
\end_inset

.
 Only show the series terms until the truncation error is 
\begin_inset Formula $\mathcal{O}\left(\left(x-x_{0}\right)^{3}\right)$
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $f(x)=\frac{x}{x+1}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=\frac{2x^{2}}{x^{4}}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=\ln x^{2}$
\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Finite differences
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size footnotesize
We can use the Taylor expansion to express any function and its derivatives
 in a 
\emph on
discrete
\emph default
 way, which means looking at the way this function changes in steps.
 
\end_layout

\begin_layout Itemize

\size footnotesize
Every step is a finite number, a small interval 
\begin_inset Formula $h$
\end_inset

.
 By truncating the series expansion at the first order derivative, the function
 at point 
\begin_inset Formula $x_{1}$
\end_inset

 can be approximated by
\begin_inset Formula 
\[
f\left(x_{1}+h\right)=f\left(x_{1}\right)+f\prime\left(x_{1}\right)h+\mathcal{O}\left(h^{2}\right)
\]

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6.5cm
\end_layout

\begin_layout Itemize

\size footnotesize
The first derivative can be approximated to the first order using the truncated
 series above, which becomes the first-order, 
\series bold
forward-difference
\series default
 approximation 
\begin_inset Formula 
\begin{equation}
f\prime\left(x_{1}\right)\approx\frac{f\left(x_{1}+h\right)-f\left(x_{1}\right)}{h}\label{eq:first-order-derivative}
\end{equation}

\end_inset

The truncation error is 
\begin_inset Formula $\mathcal{O}\left(h\right)=\mathcal{O}\left(h^{2}\right)/h$
\end_inset

.
 This is a graphical representation of the exact and approximated derivatives
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/Forward-difference-graphical.jpg
	width 6cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The approximated time derivative: first order
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:first-order-derivative"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is valid for all the continuous functions of space and time used in the
 ODE.
 
\end_layout

\begin_layout Standard
To approximate the time derivative of function 
\begin_inset Formula $f(t)$
\end_inset

 to the first order using a time step 
\begin_inset Formula $\Delta t$
\end_inset

, we write
\begin_inset Formula 
\begin{equation}
f'=\frac{df}{dt}=\frac{f(t+\Delta t)-f(t)}{\Delta t}+\mathcal{O}\left(\Delta t\right)\label{eq:first-order-timederivative}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
A simple example: The Decay Problem
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\color blue
Problem adapted from 
\begin_inset Quotes eld
\end_inset

Ocean Modelling for Beginners
\begin_inset Quotes erd
\end_inset

.

\color inherit
 
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout

\color black
Chlorophyll-a concentration at the sea- surface in the Benguela upwelling
 system measured on June 1, 2014 was 0.5 mg/m
\begin_inset Formula $^{3}$
\end_inset

.
 Zooplankton activity was claimed responsible for a daily consumption rate
 of 5
\begin_inset Formula $\%$
\end_inset

 (here we take this uptake as the only mechanism responsible for such decay).
\begin_inset Newline newline
\end_inset


\color red
How does the chlorophyll concentration evolve with time? What is the value
 after 20 days?
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Think about a solution for this problem.
 Notice that what you have to do is just to subtract 5
\begin_inset Formula $\%$
\end_inset

 off on a daily basis from the chlorophyll pool.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Recipes for initial value problems
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout

\color red
How to model the problem?
\color inherit
 And how to resolve it using numerical methods?
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Express the equation mathematically using an ODE
\end_layout

\begin_layout Enumerate
Search an analytical solution if available
\end_layout

\begin_layout Enumerate
Discretize the variables (the independent variable time and the dependent
 variables) 
\end_layout

\begin_layout Enumerate
Discretize the derivatives and all the terms in the equation using their
 finite difference approximations based on the Taylor series
\end_layout

\begin_layout Enumerate
Separate the known terms on the right hand side (rhs) and unknown terms
 on the left (lhs) and compute the forward-in-time solution
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Solving the decay problem
\begin_inset CommandInset label
LatexCommand label
name "fr:Solving-the-decay"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
1.
 Build the differential equation: Based on the system, we formulate the
 driving ODE
\begin_inset Formula 
\begin{equation}
\frac{dC}{dt}=-kC
\end{equation}

\end_inset

 C - concentration; t - time; k - constant zooplankton grazing rate 
\begin_inset Formula $k=0.05$
\end_inset

 d
\begin_inset Formula $^{-1}$
\end_inset

 
\end_layout

\begin_layout Itemize

\size small
2.
 Is there an analytical solution?: This ODE has a mathematical solution
 but we pretend we don't know it:
\begin_inset Formula 
\begin{equation}
C(t)=C_{0}e^{-kt}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize

\size small
3.
 Discretization: We define 
\emph on
discrete
\emph default
 variables to substitute the 
\emph on
continuous
\emph default
 independent variable (time) and the dependent variable (concentration)
\emph on
 
\emph default

\begin_inset Formula 
\[
t\longrightarrow t^{n}=t_{0}+n\Delta t;\ n=0,1,2,\dots,N
\]

\end_inset


\begin_inset Formula 
\[
C(t)\longrightarrow C(t^{n})=C^{n};\ n=0,1,2,\dots,N
\]

\end_inset


\size footnotesize
Note that the superscript 
\begin_inset Formula $n$
\end_inset

 
\series bold
is not an exponent
\series default
.
 It is the index of the series of values (an array).
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The simplest discretization step: Euler time-forward
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
4.
 Taylor approximation: We now write the derivative using the discretized
 form of the equation from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:first-order-timederivative"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 This is the simplest first-order approximated form but other forms can
 be used: 
\begin_inset Formula 
\begin{equation}
\frac{dC}{dt}\approx\frac{C(t+\Delta t)-C(t)}{\Delta t}\longrightarrow\frac{C^{n+1}-C^{n}}{\Delta t}
\end{equation}

\end_inset

All the terms in the equation are now turned into their discrete forms:
\begin_inset Formula 
\begin{equation}
\frac{C^{n+1}-C^{n}}{\Delta t}=-kC^{n}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize

\size small
5.
 Separation of the knowns/unknowns: The rhs now contains only known variables
\begin_inset Formula 
\begin{equation}
C^{n+1}=C^{n}-k\Delta tC^{n}=(1-k\Delta t)C^{n}
\end{equation}

\end_inset


\end_layout

\begin_layout Block
\begin_inset Argument 2
status open

\begin_layout Plain Layout
This method is called 
\series bold
explicit
\series default
 because the 
\emph on
new
\emph default
 values of 
\begin_inset Formula $C$
\end_inset

 i.e.
 
\begin_inset Formula $C^{n+1}$
\end_inset

 are explicitly given in terms of the 
\emph on
old
\emph default
 values 
\begin_inset Formula $C^{n}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The Euler-backward or implicit solution
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Step 4 can be done in different ways.
 One other simple method proposed by Euler is to discretize the explicit
 term on the right hand side using the future (unknown) value of the dependent
 variable 
\begin_inset Formula $C$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{C^{n+1}-C^{n}}{\Delta t}=-kC^{n+1}
\end{equation}

\end_inset

Step 5 now becomes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C^{n+1}=\frac{C^{n}}{(1+k\Delta t)}
\end{equation}

\end_inset

 
\end_layout

\begin_layout Block
\begin_inset Argument 2
status open

\begin_layout Plain Layout
This method is called implicit because the new values of 
\begin_inset Formula $C$
\end_inset

 i.e.
 
\begin_inset Formula $C^{n+1}$
\end_inset

 are determined in terms of the future values 
\begin_inset Formula $C^{n+1}$
\end_inset

.
 It cannot be done for all the ODEs, because it depends on the degree of
 linearity of the terms.
 Not always we can solve the equation for 
\begin_inset Formula $C^{n+1}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Properties of numerical schemes: convergence
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
A numerical scheme is said to be 
\series bold
convergent
\series default
 if its numerical solution tends towards the solution of the governing different
ial equation as the interval tend to zero
\end_layout

\begin_layout Itemize
If a scheme is unstable (see next slide), it is very unlikely to converge
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Properties of numerical schemes: stability
\begin_inset CommandInset label
LatexCommand label
name "fr:Stability"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
A numerical scheme is stable if it does not 
\emph on
diverge
\emph default
 with time.
 In simple terms, it means that the forward-in-time solution is found in
 a plausible surrounding of the value at the previous time step
\end_layout

\begin_layout Itemize
Inspecting the explicit 
\emph on
Euler forward
\emph default
 scheme 
\begin_inset Formula 
\begin{equation}
C^{n+1}=(1-k\Delta t)C^{n}
\end{equation}

\end_inset

we see that to have 
\begin_inset Formula $(1-k\Delta t)\geq0$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\color red
\begin_inset Formula $k\Delta t$
\end_inset


\color inherit
 MUST be less than or equal to 1.
 If 
\begin_inset Formula $k\Delta t>1$
\end_inset

, the resulting numerical concentration would be negative which is mathematicall
y plausible but not physically acceptable for a concentration
\end_layout

\begin_layout Itemize

\color blue
\begin_inset Formula $k\Delta t<1$
\end_inset


\color inherit
 is the conditional stability for the explicit numerical scheme: 
\color blue

\begin_inset Formula $\Delta t<1/k$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize

\color red
The stability of the solution depends on the choice of 
\begin_inset Formula $\Delta t$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise
\end_layout

\end_inset

: unconditional stability
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Now consider the implicit 
\emph on
Euler backward
\emph default
 scheme
\begin_inset Formula 
\[
C^{n+1}=\frac{C^{n}}{(1+k\Delta t)}
\]

\end_inset


\end_layout

\begin_layout Itemize

\color red
This scheme is unconditionally stable
\end_layout

\begin_layout Itemize
Demonstrate why using the same method of the previous slide
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Hybrid methods
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Implicit and explicit schemes can be combined in order to alter some properties
 of the numerical schemes and obtain more stable solutions
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C^{n+1}=C^{n}+(-\alpha kC^{n+1}-(1-\alpha)kC^{n})\Delta t
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\alpha=0$
\end_inset

 – Explicit case
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\alpha=1$
\end_inset

 – Implicit case
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\alpha=0.5$
\end_inset

 – Semi-Implicit case
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Accuracy
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
By using finite difference approximation a 
\series bold
TRUNCATION
\series default
 error is made.
\end_layout

\begin_layout Itemize
The use of 
\color blue
higher order numerics
\color inherit
 in the discretization implies smaller truncation errors.
\end_layout

\begin_layout Itemize
Since computers can represent numbers only with finite number of digits,
 there is always a 
\series bold
ROUND OFF
\series default
 error.
 This is what caused the inconsistency in the numerical solution of the
 L-V model using MATLAB in Ex.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{ex:LV}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
For the numerical solution to be accurate it 
\color blue
must have a reasonably smaller errors
\color inherit
 over the duration of the simulation.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Efficiency
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Model codes have to be written in an efficient manner such that the task
 is completed within a reasonable time-span, and 
\color blue
without stuffing up the computer
\color inherit
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
 
\begin_inset Graphics
	filename figures/comp_fire.jpg
	scale 20

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Numerical solutions for ODEs
\begin_inset CommandInset label
LatexCommand label
name "sec:Solutions-of-ODE"

\end_inset


\end_layout

\begin_layout FragileFrame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The decay ODE with the Euler-forward method in python
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6.5cm
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\tiny\sffamily},breaklines=true"
inline false
status open

\begin_layout Plain Layout

"""
\end_layout

\begin_layout Plain Layout

A numerical solution of the decay equation.
\end_layout

\begin_layout Plain Layout

"""
\end_layout

\begin_layout Plain Layout

import pylab as pl
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

t0 = 0.
     # time is in days
\end_layout

\begin_layout Plain Layout

tn = 20.
\end_layout

\begin_layout Plain Layout

dt = 10.
\end_layout

\begin_layout Plain Layout

kappa = 0.05    # day-1
\end_layout

\begin_layout Plain Layout

C0 = 0.5        # mg chl/m3
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

def F(k,C): # define the function for the right hand side of the equation
\end_layout

\begin_layout Plain Layout

    return -k*C
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# compute the total number of steps
\end_layout

\begin_layout Plain Layout

Ntot = (pl.floor((tn-t0)/dt) + 1).astype(int)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# initialization
\end_layout

\begin_layout Plain Layout

C = pl.zeros(Ntot)
\end_layout

\begin_layout Plain Layout

t = C.copy() # this array stores the time and has the same size as C
\end_layout

\begin_layout Plain Layout

t[0] = t0
\end_layout

\begin_layout Plain Layout

C[0] = C0
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# start the loop
\end_layout

\begin_layout Plain Layout

for n in range(Ntot-1):
\end_layout

\begin_layout Plain Layout

    C[n+1] = C[n] + F(kappa,C[n])*dt
\end_layout

\begin_layout Plain Layout

    t[n+1] = t[n] + dt
\end_layout

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/decay_python.png
	lyxscale 70
	width 6cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout FragileFrame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The decay ODE with the Euler-forward method in MATLAB
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6.5cm
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Matlab,basicstyle={\tiny\sffamily},breaklines=true"
inline false
status open

\begin_layout Plain Layout

% A numerical solution of the decay equation 
\end_layout

\begin_layout Plain Layout

% time is in days
\end_layout

\begin_layout Plain Layout

t0 = 0;
\end_layout

\begin_layout Plain Layout

tn = 20;
\end_layout

\begin_layout Plain Layout

dt = 10;
\end_layout

\begin_layout Plain Layout

kappa = 0.05; % day-1
\end_layout

\begin_layout Plain Layout

C0 = 0.4; % mg chl m-3
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% compute the total number of steps
\end_layout

\begin_layout Plain Layout

Ntot = floor((tn - t0)/dt) + 1;
\end_layout

\begin_layout Plain Layout

 
\end_layout

\begin_layout Plain Layout

% define the function using a MATLAB anonymous function handle
\end_layout

\begin_layout Plain Layout

F = @(k,C) -k*C;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% initializations
\end_layout

\begin_layout Plain Layout

C = zeros(Ntot,1); % this array stores the output
\end_layout

\begin_layout Plain Layout

t = C; % this array stores the time
\end_layout

\begin_layout Plain Layout

t(1) = t0;
\end_layout

\begin_layout Plain Layout

C(1) = C0;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% start the loop
\end_layout

\begin_layout Plain Layout

for n=1:Ntot-1
\end_layout

\begin_layout Plain Layout

    C(n+1) = C(n) + F(kappa,C(n))*dt;
\end_layout

\begin_layout Plain Layout

    t(n+1) = t(n) + dt;
\end_layout

\begin_layout Plain Layout

end
\end_layout

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/euler-decay.png
	lyxscale 40
	width 6cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Numerical time integration: ODE solvers
\begin_inset CommandInset label
LatexCommand label
name "fr:Numerical-time-integration"

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Most natural systems can only be described with mathematical models that
 do not have an analytical solution
\end_layout

\begin_layout Itemize
But we don't need to do the full derivation and write the computer code
 for each case
\end_layout

\begin_layout Itemize
There exist several numerical methods based on 
\series bold
finite differences
\series default
 and they are grouped under the name of 
\series bold
ODE solvers
\series default
.
 We have already used the python ODE solver called 
\family typewriter
odeint
\family default
 from the 
\family typewriter
scipy
\family default
 module
\end_layout

\begin_layout Itemize
They basically require you to input the right hand side of the differential
 equations and then use it to compute the solution forward in time at discrete
 time intervals 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Initial value methods
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
There are 3 broad categories of numerical solvers, and scientific computing
 software (python, matlab, R, julia) implement various versions.
 
\end_layout

\begin_layout Enumerate
Modified Euler-syle methods (Runge-Kutta)
\end_layout

\begin_layout Enumerate
Extrapolation type integrators (Bulirsch-Stoer)
\end_layout

\begin_layout Enumerate
Predictor-corrector methods (Adams-Bashforth-Moulton)
\end_layout

\begin_layout Standard
We will give a few examples of the first group because it's easier to understand.
 It does not mean though that it is the best to use.
 There is plenty of algorithms that have been collected in the 
\emph on
Numerical recipes
\emph default
 book by Press et al (
\begin_inset CommandInset href
LatexCommand href
target "http://numerical.recipes/"

\end_inset

) 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Limitations of the Euler method 
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\begin_layout Standard
We have already seen that the Euler method is unstable but there's more
 to that as explained below.
 In this page and in all the following examples the ODE is 
\begin_inset Formula 
\[
\frac{dy}{dx}=f\left(x,y\right)
\]

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename figures/RK1.png
	width 8cm

\end_inset


\end_layout

\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/RK2.png
	width 4cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:euler-backward-decay}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Modify the Euler-forward method implemented in the codes at the beginning
 of this section (either the python or matlab version) and change it into
 the Euler-backward method 
\end_layout

\begin_layout Itemize

\size small
Plot and compare the results for different values of 
\begin_inset Formula $\Delta t$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Runge-Kutta methods
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\begin_layout Standard
A more refined method can be obtained by evaluating the function at intermediate
 steps, as explained in the Numerical recipes textbook
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/RK3text.png
	width 8cm

\end_inset


\end_layout

\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/RK3.png
	width 4cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
4th-order Runge-Kutta (4.5)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The most popular R-K method is the classical fourth-order Runge-Kutta formula.
 It uses four evaluation points to approximate the numerical solution at
 each step:
\begin_inset Formula 
\begin{eqnarray*}
k_{1} & = & hf(x_{n},y_{n})\\
k_{2} & = & hf(x_{n}+\frac{1}{2}h,y_{n}+\frac{1}{2}k_{1})\\
k_{3} & = & hf(x_{n}+\frac{1}{2}h,y_{n}+\frac{1}{2}k_{2})\\
k_{4} & = & hf(x_{n}+h,y_{n}+k_{3})\\
y_{n+1} & = & y_{n}+\frac{1}{6}(k_{1}+2k_{2}+2k_{3}+k_{4})+O(h^{5})
\end{eqnarray*}

\end_inset

This is a great workhorse that will take you quite far with limited effort.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
ODE
\begin_inset space \space{}
\end_inset

solvers
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/ode-solvers.png
	lyxscale 50
	width 5.5cm

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
Here is a table from Glover et al (2011) explaining the various solvers
 available in MATLAB
\end_layout

\begin_layout Itemize
For MATLAB, ode45 and ode15s are the most used
\end_layout

\begin_layout Itemize
python provides package 
\family typewriter
scipy.integration
\family default
 that we used in the Lotka-Volterra model integration 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://apmonitor.com/pdc/index.php/Main/SolveDifferentialEquations
\end_layout

\end_inset

 
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout FragileFrame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The decay ODE with the R-K4.5 method in MATLAB
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6.5cm
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Matlab,basicstyle={\footnotesize\sffamily},breaklines=true"
inline false
status open

\begin_layout Plain Layout

%% Use MATLAB ODE solver
\end_layout

\begin_layout Plain Layout

% time is in days.
 dt is not needed as this solver is adaptive
\end_layout

\begin_layout Plain Layout

t0 = 0;
\end_layout

\begin_layout Plain Layout

tn = 20;
\end_layout

\begin_layout Plain Layout

kappa = 0.05; % day-1
\end_layout

\begin_layout Plain Layout

C0 = 0.4; % mg chl m-3
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% note the different use of the function handle.
 ODE solvers require a
\end_layout

\begin_layout Plain Layout

% function that takes time and the variable(s) as inputs
\end_layout

\begin_layout Plain Layout

F = @(t,C) -kappa*C;
\end_layout

\begin_layout Plain Layout

[t,C]=ode45(F,[t0 tn],C0);
\end_layout

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/RK45-decay.png
	lyxscale 40
	width 6cm

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
As you can see from the code, there is no need to define the time step.
 Only the integration limits, and the time step is automatically adjusted
 to ensure stability and convergence in an efficient way
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Compare the analytical solution of the model presented in eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:limited_growth"
plural "false"
caps "false"
noprefix "false"

\end_inset

) from Exercise 2 with the numerical solution obtained using 
\family typewriter
odeint
\family default
 in file 
\family typewriter
NP_to_NPD.ipynb
\family default
.
 Check the code carefully and how the right end side of the dynamical equation
 is implemented.
\end_layout

\begin_layout Itemize

\size small
Answer the following questions
\end_layout

\begin_deeper
\begin_layout Enumerate

\size small
What are the inputs and outputs in the function 
\family typewriter
model
\family default
? What kind of objects are they? 
\end_layout

\begin_layout Enumerate

\size small
Write a new model to simulate the nutrient-phytoplankton-detritus system
 (NPD).
 Include a detritus variable D that is produced from the mortality of phytoplank
ton and it is remineralized as a nutrient.
 This will involve adding 2 new parameters: the mortality rate (phytoplankton
 lysis) and the remineralization rate
\end_layout

\begin_layout Enumerate

\size small
Write the code to solve the new model using 
\family typewriter
odeint
\family default
 and propose some reasonable values for the parameters that lead to a realistic
 solution
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Partial differential equations
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Approximating functions of multiple variables 
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The value of a function 
\begin_inset Formula $f(x)$
\end_inset

 in the vicinity of a given location 
\begin_inset Formula $x_{0}$
\end_inset

 can be approximated with the Taylor series 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Taylor-series"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Itemize

\color red
If function 
\begin_inset Formula $f$
\end_inset

 is a multivariate function like the zonal velocity field 
\begin_inset Formula $U=U(x,y,z,t)$
\end_inset

, we have multiple discrete steps to consider around a given point 
\begin_inset Formula $x_{0},y_{0},z_{0}$
\end_inset

 at time 
\begin_inset Formula $t_{0}$
\end_inset

:
\color inherit
 
\begin_inset Formula $\Delta X=x-x_{0}$
\end_inset

; 
\begin_inset Formula $\Delta Y=y-y_{0}$
\end_inset

; 
\begin_inset Formula $\Delta Z=z-x_{0}$
\end_inset

; 
\begin_inset Formula $\Delta T=t-t_{0}$
\end_inset

; 
\end_layout

\begin_layout Itemize
The ordinary derivatives are substituted by partial derivatives for every
 independent variable
\begin_inset Newline newline
\end_inset


\begin_inset space \hspace{}
\length 0.1in
\end_inset

 
\begin_inset Formula $\frac{\partial U}{\partial x}\arrowvert_{x=x_{0},y,z,t}$
\end_inset

;
\begin_inset space \hspace{}
\length 0.1in
\end_inset

 
\begin_inset Formula $\frac{\partial U}{\partial y}$
\end_inset

; 
\begin_inset space \hspace{}
\length 0.1in
\end_inset

 
\begin_inset Formula $\frac{\partial^{2}U}{\partial x^{2}}$
\end_inset

 ; 
\begin_inset space \hspace{}
\length 0.1in
\end_inset

 
\begin_inset Formula $\frac{\partial U}{\partial t}$
\end_inset


\end_layout

\begin_layout Itemize
The formal notation can become pretty heavy, because time and space have
 to be considered.
 We will therefore drop some variables to simplify the writing, or we will
 use the vector notation 
\begin_inset Formula $x_{i}=\left(x_{1},x_{2},x_{3}\right)\equiv\left(x,y,z\right)$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Taylor series for PDE
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
With this notations in mind, we can modify eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Taylor-series"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to obtain the Taylor Series approximation for the multivariate functions
 in the surrounding of any time value 
\begin_inset Formula $t$
\end_inset

 (the choice of the truncation error is arbitrary): 
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(t+\Delta t,x,y,z) \textcolor{red}{=} U(t,x,y,z) + \frac{\partial U}{\partial t} \Delta t + \frac{1}{2!} \frac{\partial^{2}U}{\partial t^{2}}\Delta t^{2} + \textcolor{red}{O(\Delta t^{3})} }\label{eq:Taylor_Ut}
\end{equation}

\end_inset

and space point 
\begin_inset Formula $x_{i}$
\end_inset

:
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(t,x_{i}+\Delta x_{i}) \textcolor{red}{=} U(t,x_{i}) + \frac{\partial U}{\partial x_{i}} \Delta x_{i} + \frac{1}{2!} \frac{\partial^{2}U}{\partial x_{i}^{2}}\Delta x_{i}^{2} + \frac{1}{3!} \frac{\partial^{3}U}{\partial x_{i}^{3}}\Delta x_{i}^{3} + \textcolor{red}{O(\Delta x_{i}^{4})} }
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta x_{i}$
\end_inset

 is the increment along one of the 3 spatial directions.
 To simplify the notation we will only work with the x-axis, thus dropping
 the index 
\begin_inset Formula $i$
\end_inset

 
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(t,x+\Delta x,y,z) \textcolor{red}{=} U(t,x,y,z) + \frac{\partial U}{\partial x} \Delta x + \frac{1}{2!} \frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} + \frac{1}{3!} \frac{\partial^{3}U}{\partial x^{3}}\Delta x^{3} + \textcolor{red}{O(\Delta x^{4})} }\label{eq:Taylor_Ux}
\end{equation}

\end_inset

The same form is used for y and z.
 [we will also drop the 
\begin_inset Formula $(t,...,y,z)$
\end_inset

 from function 
\begin_inset Formula $U$
\end_inset

 since we are only working with functions of more than one variable]
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Important difference: space has no preferential direction
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The spatial gradients exist in all directions.
 Think about the slope of a mountain: you can measure it by walking uphill
 or downhill.
 The step 
\begin_inset Formula $\Delta x$
\end_inset

 can thus be either positive or negative, and we should still find exactly
 the same function
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(x-\Delta x) \textcolor{red}{=} U(x) - \frac{\partial U}{\partial x} \Delta x + \frac{1}{2!} \frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} -\frac{1}{3!} \frac{\partial^{3}U}{\partial x^{3}}\Delta x^{3} + \textcolor{red}{O(\Delta x^{4})} }\label{eq:backward}
\end{equation}

\end_inset

This is equivalent to the previous eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Taylor_Ux"
plural "false"
caps "false"
noprefix "false"

\end_inset

, with the only difference that we now look backward instead of forward.
 We are evaluating the same function, just in a different way.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Discrete grids for PDE
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
5cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/grid_disc.png
	width 5cm

\end_inset


\end_layout

\begin_layout Standard

\size small
The function 
\begin_inset Formula $U(x,t)$
\end_inset

 needs a two dimensional discrete grid, one axis for space and another axis
 for time.
 The value of the function exists at every node of the grid.
 If 
\begin_inset Formula $U(x,y,z,t)$
\end_inset

 then we will need 4 dimensions.
 
\end_layout

\begin_layout Column
7cm
\end_layout

\begin_layout Itemize

\size small
For educational purposes, we choose equally spaced points along the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 dimensions and discretize the independent variables as done 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:Solving-the-decay"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
x_{i}=x_{0}+i\Delta x;\ t_{n}=t_{0}+n\Delta t
\]

\end_inset

to describe the discrete function 
\begin_inset Formula 
\[
U_{i}^{n}=U\left(x_{i},t_{n}\right).
\]

\end_inset


\end_layout

\begin_layout Itemize

\size small
Hopping on the grid of one or more time and space steps can be written in
 a convenient way
\begin_inset Formula 
\[
U(x+\Delta x,t)=U_{i+1}^{n};\;U(x,t+\Delta t)=U_{i}^{n+1}
\]

\end_inset

 A full 3-D variable would be written as 
\begin_inset Formula $U_{i,j,k}^{n}$
\end_inset

 which is shorter than 
\begin_inset Formula $U(x,y,z,t)$
\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
PDE problems
\begin_inset CommandInset label
LatexCommand label
name "fr:PDE-problems"

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard

\size footnotesize
Comparison of initial values and boundary value problems in PDE (Press et
 al.
 1997) 
\end_layout

\begin_layout Itemize

\size footnotesize
In (a) initial values are given on one “time slice,” and it is desired to
 advance the solution in time, computing successive rows of open dots in
 the direction shown by the arrows.
 Boundary conditions at the left and right edges of each row (⊗) must also
 be supplied, but only one row at a time.
 Only one, or a few, previous rows need be maintained in memory.
 
\end_layout

\begin_layout Itemize

\size footnotesize
In (b), boundary values are specified around the edge of a grid, and an
 iterative process is employed to find the values of all the internal points
 (open circles).
 All grid points must be maintained in memory.
\end_layout

\begin_layout Column
7cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/PDE-initial-boundary.png
	lyxscale 60
	width 6.5cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Finite difference approximation: first order in time
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\color red
The time derivative
\color inherit
 can be approximated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Taylor_Ut"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the simplest possible manner using a first order forward time step as
 done for the ODE functions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:first-order-timederivative"
plural "false"
caps "false"
noprefix "false"

\end_inset

:
\begin_inset Formula 
\begin{equation}
\frac{\partial U}{\partial t}=\frac{U(t_{i}+\Delta t)-U(t_{i})}{\Delta t}+\textcolor{red}{O(\Delta t)}
\end{equation}

\end_inset

On the discrete grid introduced a few slides earlier, this becomes
\begin_inset Formula 
\[
\frac{\partial U}{\partial t}\approx\frac{U_{i}^{n+1}-U_{i}^{n}}{\Delta t}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
First order approximation: forward in space
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
By approximating the function 
\begin_inset Formula $U(x,y,z,t)$
\end_inset

 to the first order along the positive 
\begin_inset Formula $x$
\end_inset

, we obtain a truncation error that is proportional to 
\begin_inset Formula $\Delta x^{2}$
\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(x+\Delta x)=U(x) + \frac{\partial U}{\partial x} \Delta x + \textcolor{red}{O(\Delta x^{2})} }
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
If we now solve for the derivative, we obtain its first-order approximation
 and the grid-based equivalent form for the 
\series bold
forward in space approximation
\series default
, which is sometimes called downstream: 
\begin_inset Formula 
\begin{equation}
\frac{\partial U}{\partial x}=\frac{U(x+\Delta x)-U(x)}{\Delta x}+\textcolor{red}{O(\Delta x)}\rightarrow\frac{\partial U}{\partial x}\approx\frac{U_{i+1}^{n}-U_{i}^{n}}{\Delta x}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
Note that the truncation error for the derivatives is now 
\begin_inset Formula $O(\Delta x)$
\end_inset

 because we divide by 
\begin_inset Formula $\Delta x$
\end_inset

 and that the spatial differences are taken at the same time index 
\begin_inset Formula $n$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise
\end_layout

\end_inset

: backward in space
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
Following the concepts of the previous slide and the backward Taylor expansion
 shown in eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:backward"
plural "false"
caps "false"
noprefix "false"

\end_inset

, write the first order approximation and truncation error of
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\textcolor{blue}{ U(x - \Delta x)= }
\]

\end_inset

Rearrange the equation to solve for the derivative 
\begin_inset Formula 
\[
\frac{\partial U}{\partial x}=
\]

\end_inset

and show the 
\series bold
backward in space approximation
\series default
 (sometimes called upstream) using the discrete indices
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\frac{\partial U}{\partial x}\approx
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Other finite difference approximations: centred in space
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
Both the forward and backward approximations are valid and equal, as well
 as it is any linear combination of both, which incidentally cancels the
 error if we start from the Taylor series and take the difference term by
 term
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(x+\Delta x)=U(x) + \frac{\partial U}{\partial x} \Delta x + \frac{1}{2!} \frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} +\textcolor{red}{O(\Delta x^{3})} }
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(x - \Delta x)=U(x) - \frac{\partial U}{\partial x} \Delta x + \frac{1}{2!} \frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} + \textcolor{red}{O(\Delta x^{3})} }
\end{equation}

\end_inset

This leads to the centred difference approximation
\begin_inset Formula 
\begin{equation}
\frac{\partial U}{\partial x}=\frac{U(x+\Delta x)-U(x-\Delta x)}{2\Delta x}+\textcolor{red}{O(\Delta x^{2})}\rightarrow\frac{\partial U}{\partial x}\approx\frac{U_{j+1}^{n}-U_{j-1}^{n}}{2\Delta x}\label{eq:centred-difference}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size small
Note that the centered difference form of the first derivative is accurate
 to the second order (i.e.
 has a relatively smaller error than the forms shown in the previous slide)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Higher order derivatives
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
Using a similar method, one can obtain the other higher order derivatives
 
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ U(x + \Delta x) \textcolor{red}{=} U(x) + \frac{\partial U}{\partial x} \Delta x + \frac{1}{2!} \frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} + \textcolor{red}{O(\Delta x^{3})} }
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\textcolor{blue}{\frac{\partial^{2}U}{\partial x^{2}}\Delta x^{2} \textcolor{red}{=}2\left[U(x+\Delta x)-U(x)-\frac{\partial U}{\partial x}\Delta x\right] + \textcolor{red}{O(\Delta x^{3})} }
\end{equation}

\end_inset

We now replace the full expression for the first order derivative, but to
 have the same order of error we need to use the centred difference 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:centred-difference"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and obtain
\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}U}{\partial x^{2}}=\frac{U(x+\Delta x)-2U(x)+U(x_{i}-\Delta x)}{\Delta x^{2}}+\textcolor{red}{O(\Delta x)}\label{eq:2nd-order-derivative}
\end{equation}

\end_inset

We need more points to compute higher order derivatives.
 Remember that the 2nd derivative measures the curvature and it is understandabl
e that more than 2 points are required.
 This unfortunately has the consequence to increase the truncation error,
 so this is less accurate.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The stencil concept
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/time-space-discretization.png
	scale 50

\end_inset


\begin_inset Graphics
	filename figures/stencil.jpg
	lyxscale 50
	scale 10

\end_inset


\end_layout

\begin_layout Standard
To represent the functioning of a numerical scheme we use the concept of
 the 
\series bold
stencil
\series default
.
 The solution in time will depend on a fixed set of determined points in
 space.This example shows the forward-in-time and centred-in-space scheme(FCTS)
 that is the simplest scheme for PDE illustrated mathematically in the next
 slide.
 This scheme can be used to solve the advection and diffusion problems as
 it will become clearer with the examples in the next section.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout PlainFrame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Cheat sheet: approximated derivatives for PDEs
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status open

\begin_layout Plain Layout

\series bold
Forward
\series default
 in time, 
\series bold
centered
\series default
 in space (FCTS)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ \textcolor{black}{Forward - Time:} \hspace{0.2in} \frac{\partial U}{\partial t} = \frac{U(t_{i}+\Delta t)-U(t_{i})}{\Delta t} }+\textcolor{red}{O(\Delta x)}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ \textcolor{black}{Centered - Space:} \hspace{0.2in} \frac{\partial U}{\partial x} = \frac{U(x_{i}+\Delta x)-U(x_{i}-\Delta x)}{2\Delta x} + \textcolor{red}{O(\Delta x^{2})} }
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ \textcolor{black}{Centered - Space:} \hspace{0.2in} \frac{\partial U}{\partial y} = \frac{U(y_{i}+\Delta y)-U(y_{i}-\Delta y)}{2\Delta y} + \textcolor{red}{O(\Delta y^{2})} }
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\textcolor{blue}{ \textcolor{black}{Centered - Space:} \hspace{0.2in} \frac{\partial U}{\partial z} = \frac{U(z_{i}+\Delta z)-U(z_{i}-\Delta z)}{2\Delta z} + \textcolor{red}{O(\Delta z^{2})} }\label{eq:du/dz}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Write the grid-based, discretized form of eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2nd-order-derivative"
plural "false"
caps "false"
noprefix "false"

\end_inset

, first defining the discrete time and space axes to be used as indices
\begin_inset Formula 
\[
t^{n}=\qquad;x_{i}=
\]

\end_inset


\size footnotesize

\begin_inset Formula 
\[
\frac{\partial^{2}U}{\partial x^{2}}\approx
\]

\end_inset


\end_layout

\begin_layout Itemize
Given the discrete 3-D horizontal velocity field 
\begin_inset Formula $U_{ijk}^{n}$
\end_inset

, write the discretized form of eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:du/dz"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Numerical ocean modelling
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The driving equations
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Ocean models determine the state of the ocean using basic physical (non-linear)
 relationships 
\color red
(Primitive Equations).
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Navier-Stokes equation (Momentum balance).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

 
\begin_inset Formula $\sum$
\end_inset

Forces = Gravity + Pressure gradient force + Coriolis +Friction.
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Continuity equations (Water, Salt, Heat conservation).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

 What goes in, eventually comes out.
 There is no gain/loss in the system (Changes are only due to imbalances).
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Equation of State
\color inherit
.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

 Density varies in a non-linear and complex way with Temperature, Salinity
 and Pressure.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The full set of equations
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\boxed{\textrm{Momentum}\underbrace{\ \frac{D\mathbf{u}}{Dt}\ }_{\textrm{Total acceleration}}=\underbrace{-\frac{\nabla p}{\rho}}_{\textrm{Pressure gradient}}\underbrace{-f\mathbf{\hat{k}}\times\mathbf{u}}_{\textrm{Coriolis}}\underbrace{-\nabla\phi}_{\textrm{Geopotential}}\underbrace{+\boldsymbol{\mathcal{F}}}_{\textrm{Friction}}}
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\boxed{\textrm{Water}\underbrace{\nabla\cdot\mathbf{u}}_{\textrm{Incompressible fluid}}=0}
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\boxed{\textrm{Potential temperature}\underbrace{\ \frac{D\mathbf{\theta}}{Dt}\ }_{\textrm{Total rate of change}}=\underbrace{\Theta}_{\textrm{Turbulent fluxes}}}
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\boxed{\textrm{Salt}\underbrace{\ \frac{DS}{Dt}\ }_{\textrm{Total rate of change}}=\underbrace{\Sigma}_{\textrm{Turbulent fluxes}}}
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\boxed{\textrm{Equation of state}\ \ \rho=\rho\left(\theta,\ S,\ P\right)}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Component form (Boussinesq+hydrostatic+constant friction)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial u}{\partial t}+u\frac{\partial u}{\partial x}+v\frac{\partial u}{\partial y}+w\frac{\partial u}{\partial z}-fv & =-\frac{1}{\rho_{0}}\frac{\partial p}{\partial x}+A_{H}\left(\frac{\partial^{2}u}{\partial x^{2}}+\frac{\partial^{2}u}{\partial y^{2}}\right)+A_{V}\frac{\partial^{2}u}{\partial z^{2}}\\
\frac{\partial v}{\partial t}+u\frac{\partial v}{\partial x}+v\frac{\partial v}{\partial y}+w\frac{\partial v}{\partial z}+fu & =-\frac{1}{\rho_{0}}\frac{\partial p}{\partial y}+A_{H}\left(\frac{\partial^{2}v}{\partial x^{2}}+\frac{\partial^{2}v}{\partial y^{2}}\right)+A_{V}\frac{\partial^{2}v}{\partial z^{2}}\\
\frac{\partial p}{\partial z} & =-\rho_{0}g\\
\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}+\frac{\partial w}{\partial z} & =0\\
\frac{\partial\theta}{\partial t}+u\frac{\partial\theta}{\partial x}+v\frac{\partial\theta}{\partial y}+w\frac{\partial\theta}{\partial z} & =\kappa_{H}\left(\frac{\partial^{2}\theta}{\partial x^{2}}+\frac{\partial^{2}\theta}{\partial y^{2}}\right)+\kappa_{V}\frac{\partial^{2}\theta}{\partial z^{2}}\\
\frac{\partial S}{\partial t}+u\frac{\partial S}{\partial x}+v\frac{\partial S}{\partial y}+w\frac{\partial S}{\partial z} & =\kappa_{H}\left(\frac{\partial^{2}S}{\partial x^{2}}+\frac{\partial^{2}S}{\partial y^{2}}\right)+\kappa_{V}\frac{\partial^{2}S}{\partial z^{2}}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Numerical solution of hydrodynamical equations
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
the 3D primitive equations of the oceans are complex.
 They are non linear and involve many partial derivatives 
\end_layout

\begin_layout Itemize

\size small
It is useful to analyse portions of the full equations that are nevertheless
 meaningful to understand how numerical methods works.
 The methods described in the next slides are not used in modern numerical
 models because they are not much efficient, but the underlying concepts
 are the same.
 We will consider the
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
Advection terms: transport of a property due to the current speed
\end_layout

\begin_layout Itemize

\size small
Turbulent diffusion terms: the parameterization of mixing due to the presence
 of spatial gradients in a property
\end_layout

\end_deeper
\begin_layout Itemize

\size small
We will work on the advection and diffusion of a scalar variable in one
 dimension, along the 
\begin_inset Formula $x$
\end_inset

 direction, assuming a constant velocity field and a constant turbulent
 diffusivity
\begin_inset Formula 
\begin{equation}
\frac{\partial\theta}{\partial t}+c\frac{\partial\theta}{\partial x}=\kappa\frac{\partial^{2}\theta}{\partial x^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize

\size small
This is a combination of an initial value and a boundary value problem,
 complex enough to understand the numerical methods
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Subsection
Advection
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
An advection example in one dimension
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size small
We model a longitudinal estuary, where the current velocity is along the
 
\begin_inset Formula $x$
\end_inset

 direction and constant; 
\begin_inset Formula $u=c$
\end_inset

 and 
\begin_inset Formula $v=0$
\end_inset

 
\end_layout

\begin_layout Itemize

\size small
It's a wide estuary, with homogeneous processes in the meridional and vertical
 directions: 
\begin_inset Formula $\partial_{y}=0$
\end_inset

 and 
\begin_inset Formula $\partial_{z}=0$
\end_inset

 for all properties
\end_layout

\begin_layout Itemize

\size small
The vertical depth is too small to generate effective vertical velocities:
 
\begin_inset Formula $w=0$
\end_inset


\end_layout

\begin_layout Itemize

\size small
An initial perturbation of temperature (e.g.
 hot water leak from a power plant) occurs at one point in time and over
 a range of space.
 We want to study the evolution of this perturbation, which is described
 by the 1D advection equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial\theta}{\partial t}+c\frac{\partial\theta}{\partial x}=0
\]

\end_inset


\begin_inset Graphics
	filename figures/river-mouth.png
	lyxscale 70
	width 8cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
What do we expect?
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The solution we expect is the transport of the perturbation along the estuary.
 We are not considering heat exchange or turbulent dissipation, so the signal
 will remain undeformed throughout the pathway.
 This assumption is not fully realistic but simple to implement codewise
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/river-mouth-evolution.png
	lyxscale 60
	width 8cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The expected result shown as a mathematical function
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The solution we expect is the transport of the perturbation along the estuary.
 We are not considering heat exchange or dissipation, so the signal stays
 undeformed throughout the pathway
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/wave-advection.png
	lyxscale 60
	width 8cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Building the mathematical model
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset VSpace -1cm
\end_inset


\begin_inset Graphics
	filename figures/advection_IC.png
	lyxscale 30
	width 4.5cm

\end_inset


\begin_inset VSpace 0cm
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/advection_IC_3D.png
	lyxscale 30
	width 5.5cm

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Itemize

\size footnotesize
For the spatial representation, we choose a channel of length 20 km and
 an initial grid step of 500 m.
 All features are homogeneous along 
\begin_inset Formula $y$
\end_inset

, so we just need to describe the x-axis
\end_layout

\begin_layout Itemize

\size footnotesize
Our choice for the initial condition function is a smoothly peaked function,
 the Gaussian function, that is controlled by 
\begin_inset Formula $A$
\end_inset

 the amplitude and 
\begin_inset Formula $\sigma$
\end_inset

 the width parameter: 
\begin_inset Formula 
\[
\theta(t_{0},x)=\theta_{0}+Ae^{-\left(\frac{x}{\sigma}\right)^{2}}
\]

\end_inset

By centering the x-axis around 
\begin_inset Formula $x_{0}=0$
\end_inset

, we get a nicely shaped perturbation.
 
\begin_inset Formula $x$
\end_inset

 is in m, but we are showing km in the plot
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Analytical solution
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size scriptsize
The solution is a function that should 
\series bold
behave like a moving wave
\series default
.
 The perturbation is moving following the speed of the current, which means
 that if we stay at the same location in space and time (say our 
\begin_inset Formula $x_{0}$
\end_inset

 and 
\begin_inset Formula $t_{0}$
\end_inset

), after a certain time step 
\begin_inset Formula $\delta t$
\end_inset

 we should see the passage of the signal that was 
\begin_inset Quotes erd
\end_inset

behind us
\begin_inset Quotes erd
\end_inset

 at a distance 
\begin_inset Formula $\delta x=x_{0}-c\delta t$
\end_inset

 at time 
\begin_inset Formula $t_{0}-\delta t$
\end_inset

.
\end_layout

\begin_layout Itemize

\size scriptsize
This is exactly equivalent as to say that the signal has moved of a distance
 
\begin_inset Formula $\delta x=x_{0}+c\delta t$
\end_inset

 after a time interval 
\begin_inset Formula $\delta t$
\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
Wave solutions mix time and space, that is we are seeking for a function
 of 2 independent variables that are linked by the phase velocity
\begin_inset Formula 
\[
\theta=\theta\left(x,t\right)=\theta\left(x-ct\right)
\]

\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
Mathematically, we are using a variable substitution: we say that the temperatur
e function 
\begin_inset Formula $\theta$
\end_inset

 is regulated by a new independent variable 
\begin_inset Formula $\chi=x-ct$
\end_inset

, 
\begin_inset Formula $\theta=\theta\left(\chi\right)$
\end_inset

, which is a linear combination of the basic independent variables
\end_layout

\begin_layout Itemize

\size scriptsize
By using the chain rule to derive the function of a function, we can verify
 that this function is a solution of the PDE
\begin_inset Formula 
\begin{align*}
\frac{\partial\theta}{\partial t}= & \frac{\partial\theta}{\partial\chi}\frac{\partial\chi}{\partial t}=-c\frac{\partial\theta}{\partial\chi}\\
\frac{\partial\theta}{\partial x}= & \frac{\partial\theta}{\partial\chi}\frac{\partial\chi}{\partial x}=\frac{\partial\theta}{\partial\chi}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{}
\end_layout

\end_inset

: display the analytical solution
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
5cm
\end_layout

\begin_layout Itemize
Run the following script using python: 
\family typewriter
advection_analytical.py
\family default
 (note: this is not a jupyter notebook)
\end_layout

\begin_deeper
\begin_layout Enumerate
What happens if you change the values of 
\begin_inset Formula $dx$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

?
\end_layout

\begin_layout Enumerate
What happens if you increase or decrease the parameter 
\begin_inset Formula $\sigma$
\end_inset

?
\end_layout

\end_deeper
\begin_layout Itemize
To learn more about animations with matplotlib: 
\begin_inset CommandInset href
LatexCommand href
target "https://towardsdatascience.com/animations-with-matplotlib-d96375c5442c"

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/advection_analytical_3D.png
	lyxscale 30
	scale 30

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Frame

\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The grid for the advection equation
\begin_inset CommandInset label
LatexCommand label
name "fr:advection-grid"

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/time-space-discretization.png
	scale 50

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
This is the stencil that shows how the solution in time depends on the space
 variable.
 A quite natural choice for the numerical schemes is to use a forward scheme
 in time and a centered scheme in space (FTCS).
 In this example, you should substitute 
\begin_inset Formula $U$
\end_inset

 with our temperature variable 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 with 
\begin_inset Formula $i$
\end_inset

 (
\begin_inset Formula $i$
\end_inset

 is more natural for indicating the index along the x-axis.
 We choose equally spaced points along the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 dimensions
\begin_inset Formula 
\[
x_{i}=x_{0}+i\Delta x;\ t_{n}=t_{0}+n\Delta t
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
and we seek for the solution 
\begin_inset Formula $\theta_{i}^{n}=\theta\left(x_{i},t_{n}\right)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Derivation of the discrete advection equation
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\begin{equation}
\frac{\partial\theta}{\partial t}+c\frac{\partial\theta}{\partial x}=0
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
We have several choices for the derivative term, but the most obvious way
 is the explicit Euler forward for time integration
\begin_inset Formula 
\begin{equation}
\frac{\partial\theta}{\partial t}=\frac{\theta_{i}^{n+1}-\theta_{i}^{n}}{\Delta t}+\mathcal{O}\left(\Delta t\right)\label{eq:adv_FT}
\end{equation}

\end_inset

The advantage of this scheme is that it is explicit: one only needs the
 known quantities at time step 
\begin_inset Formula $n$
\end_inset

 to compute the solution at 
\begin_inset Formula $n+1$
\end_inset

.
 For the space derivative we use the explicit centered-difference scheme
\begin_inset Formula 
\begin{equation}
\frac{\partial\theta}{\partial x}=\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2\Delta x}+\mathcal{O}\left(\Delta x^{2}\right)\label{eq:adv_CS}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
By combining eqs.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:adv_FT"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:adv_CS"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we obtain the complete discrete form
\begin_inset Formula 
\[
\frac{\theta_{i}^{n+1}-\theta_{i}^{n}}{\Delta t}=-c\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2\Delta x}
\]

\end_inset

which can be rearranged to get the forward-in-time value 
\begin_inset Formula $\theta_{i}^{n+1}$
\end_inset


\begin_inset Formula 
\[
\theta_{i}^{n+1}=\theta_{i}^{n}-c\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2\Delta x}\Delta t
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
A basic algorithm for the numerical scheme
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/advection_algorithm.png
	lyxscale 50
	height 80pheight%

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Is that all?
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
One may think that by having the algorithm, we now have all the ingredients
 to go to the computer room, code it and get a “good solution”.
 And, obviously, the computer will give some results if we implement the
 previous algorithm...
\end_layout

\begin_layout Enumerate
Is the code efficient or does just work?
\end_layout

\begin_layout Enumerate
Will our numerical solution be meaningful? 
\begin_inset Formula $\Longrightarrow$
\end_inset

 Convergence
\end_layout

\begin_layout Enumerate
Can we improve it by choosing other finite difference schemes for our partial
 derivatives? 
\begin_inset Formula $\Longrightarrow$
\end_inset

 Consistency - Order and accuracy
\end_layout

\begin_layout Enumerate
How can we choose values for 
\begin_inset Formula $\Delta x$
\end_inset

 and 
\begin_inset Formula $\Delta t$
\end_inset

? 
\begin_inset Formula $\Longrightarrow$
\end_inset

 Stability analysis 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Stability: the Courant number
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
By rearranging the numerical solution of the FTCS scheme
\begin_inset Formula 
\[
\theta_{i}^{n+1}=\theta_{i}^{n}-c\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2\Delta x}\Delta t
\]

\end_inset

we can observe that the value of the function at 
\begin_inset Formula $\theta_{i}^{n}$
\end_inset

 is modified by the gradient through the action of a non-dimensional number
\begin_inset Formula 
\begin{equation}
\theta_{i}^{n+1}=\theta_{i}^{n}-c\frac{\Delta t}{\Delta x}\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2}\label{eq:advection_FCTS_courant}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\mathcal{C}=c\frac{\Delta t}{\Delta x}=\frac{c}{\Delta x/\Delta t}
\]

\end_inset

which is called the 
\series bold
Courant number
\series default
 (or Courant-Friedrichs-Lewy CFL condition).
 This is the ratio between the current speed and what we may call the 
\begin_inset Quotes eld
\end_inset

speed
\begin_inset Quotes erd
\end_inset

 that can be captured by the discrete numerical scheme.
 
\end_layout

\begin_layout Standard

\size footnotesize
In the case of the upstream or downstream spatial schemes, we also find
 the Courant number:
\begin_inset Formula 
\[
\theta_{i}^{n+1}=\theta_{i}^{n}-\mathcal{C}\left(\theta_{i}^{n}-\theta_{i-1}^{n}\right);\ \theta_{i}^{n+1}=\theta_{i}^{n}-\mathcal{C}\left(\theta_{i+1}^{n}-\theta_{i}^{n}\right)
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Stability: significance of the Courant number
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
A scheme is stable if the solution is meaningful.
 This means that the advection should not take away from the grid box an
 amount of the quantity that is larger than what is available.
 Numerical errors may create 
\emph on
overshooting
\emph default
 and 
\emph on
undershooting
\emph default
, which means that more temperature is advected away from one side of the
 cell than it is replaced by the same process on the other side.
 We are thus seeking for the positiveness of the solution (see the slide
 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:Stability"
plural "false"
caps "false"
noprefix "false"

\end_inset

), and write this mathematically as 
\begin_inset Formula $\theta_{i}^{n+1}\ge0$
\end_inset

.
 Using the FTCS solution we obtain:
\begin_inset Formula 
\[
\theta_{i}^{n}-\mathcal{C}\frac{\theta_{i+1}^{n}-\theta_{i-1}^{n}}{2}\ge0
\]

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
which has to be true for every value of the gradient.
 Since we cannot control the gradient value, the 
\series bold
Courant number must be close to 0
\series default
, to ensure positiveness of the solution (note that this does not mean that
 the temperature cannot become negative if it would physically do so).
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:advection}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size tiny
The numerical solution of the advection problem is implemented in the notebook
 
\family typewriter
advection.ipynb
\family default
.
 Familiarize yourself with the code and answer the following questions:
\end_layout

\begin_layout Enumerate

\size tiny
Look for the comment 
\family typewriter
#Question 1
\family default
 in the code.
 What do you think the next two lines do? [hint: see slide 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:PDE-problems"
plural "false"
caps "false"
noprefix "false"

\end_inset

]
\end_layout

\begin_layout Enumerate

\size tiny
Look for 
\family typewriter
#Question 2
\family default
 in the code.
 Which component of the numerical scheme is implemented in line 
\family typewriter
#L1
\family default
? What does line 
\family typewriter
#L2
\family default
 do? 
\end_layout

\begin_layout Enumerate

\size tiny
Look for 
\family typewriter
#Question 3
\family default
 in the code.
 Why the code does not perform the computation on all the elements of the
 array 
\family typewriter
T
\family default
, i.e.
 
\family typewriter
T[:,n]
\family default
?
\end_layout

\begin_layout Enumerate

\size tiny
Analysis of the numerical solution.
 How different is the numerical solution from the expected moving perturbation?
 What is the possible reason?
\end_layout

\begin_layout Enumerate

\size tiny
Make a copy of the notebook to play with the parameters (File|Make a copy).
 The grid parameters determine the value of the Courant number and hence
 the stability.
 The spatial and temporal steps are linked.
 More spatial resolution (smaller 
\begin_inset Formula $dx$
\end_inset

) means that 
\begin_inset Formula $dt$
\end_inset

 must also decrease to maintain the same Courant number.
 However, things are not so simple.
 The higher spatial resolution (which should theoretically increase the
 Courant number) also enhance the capability to resolve the real gradients
 (see the previous slide to understand how 
\begin_inset Formula $\mathcal{C}$
\end_inset

 interacts with the difference between adjacent points).
 If you increase the Courant number to 1 by halving 
\begin_inset Formula $dx$
\end_inset

, what does it happen? Now set 
\begin_inset Formula $dx=500$
\end_inset

 m and 
\begin_inset Formula $dt=100$
\end_inset

 s to get 
\begin_inset Formula $\mathcal{C}=0.1$
\end_inset

; what do you see and how would you interpret it?
\end_layout

\begin_layout Enumerate

\size tiny
The choice of the grid parameters also depend on the features that you want
 to resolve.
 Make another copy of the original notebook and set the parameter 
\begin_inset Formula $\sigma=1000$
\end_inset

 m (a steeper wave).
 What do you have to do to recover the same degree of accuracy of the previous
 solution? (note that it takes longer to generate the movie when you decrease
 the time step because NT increases and more frames are generated).
 Make another copy of the original notebook and double the current speed.
 How would you explain the result?
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Subsection
Diffusion
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
A diffusion problem in the estuary
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/diffusion_estuary.png
	lyxscale 50
	scale 30

\end_inset


\end_layout

\begin_layout Standard

\size small
This case is similar to the heat anomaly advection.
 In this case we assume that the spill is coming from a sewage treatment
 pipe with a very high dissolved inorganic nitrogen concentration (DIN,
 measured in mmol m
\begin_inset Formula $^{-3}$
\end_inset

)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Reminder: molecular and eddy viscosity/diffusivity 
\begin_inset CommandInset label
LatexCommand label
name "fr:eddy-viscosity-diffusivity"

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/viscosity.png
	lyxscale 30
	width 3cm

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/stirring_checkerboard.png
	lyxscale 50
	height 6cm

\end_inset


\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize

\series bold
\size tiny
Friction
\series default
 in a moving fluid results from the transfer of 
\series bold
momentum
\series default
 between different parts of the fluid.
 The physical process that 
\begin_inset Quotes eld
\end_inset

transmit
\begin_inset Quotes erd
\end_inset

 momentum is called 
\series bold
viscosity
\series default
, which can be seen as the resistance of the fluid to motion.
 In a laminar flow, momentum exchange occurs as a result of the transfer
 of molecules with different velocities between adjacent layers: 
\series bold
molecular viscosity
\series default
.
 The propension of the fluid to transfer heat and dissolved chemicals is
 the 
\series bold
molecular diffusivity
\series default
, which depends on the characteristic of both the fluid and the substance.
 Molecular viscosity and diffusivity are found to be proportional to the
 mean velocity of the molecules and the mean pathway.
 Kinematic viscosity and molecular diffusivity have units of m
\begin_inset Formula $^{2}$
\end_inset

 s
\begin_inset Formula $^{-1}$
\end_inset

.
 
\end_layout

\begin_layout Itemize

\series bold
\size tiny
Turbulence occurs at scales above the molecular level
\series default
.
 Patches of fluids are stirred and diffused following internal eddies.
 The stirring generates new gradients that are dispersed due to molecular
 diffusion.
 
\series bold
Eddy diffusivity
\series default
 (of heat/substances) and 
\series bold
eddy viscosity
\series default
 (of momentum) are parameterized similarly to the molecular equivalents
 but are much larger
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/viscosity-diffusivity-table.png
	lyxscale 50
	width 8cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The discrete diffusion equation
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
\begin_inset Formula 
\begin{equation}
\frac{\partial N}{\partial t}=\kappa\frac{\partial^{2}N}{\partial x^{2}}
\end{equation}

\end_inset

We use the same approach seen when discretizing the advection 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:advection-grid"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We seek for a discrete solution 
\begin_inset Formula $N_{i}^{n}$
\end_inset

.
 The main difference is that we now have to write the approximation of the
 second order derivative seen in eq.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2nd-order-derivative"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\begin{align}
\frac{\partial^{2}N}{\partial x^{2}}= & \frac{N(x_{0}+\Delta x)-2N(x_{0})+N(x_{0}-\Delta x)}{\Delta x^{2}}+O(\Delta x)\\
\left.\frac{\partial^{2}N}{\partial x^{2}}\right|_{n,i}= & \frac{N_{i+1}^{n}-2N_{i}^{n}+N_{i-1}^{n}}{\Delta x^{2}}+\mathcal{O}\left(\Delta x\right)
\end{align}

\end_inset

We combine the Euler-forward time scheme with the second derivative 
\size footnotesize

\begin_inset Formula 
\[
\frac{\partial N}{\partial t}=\frac{N_{i}^{n+1}-N_{i}^{n}}{\Delta t}+\mathcal{O}\left(\Delta t\right)
\]

\end_inset


\size small
to obtain the discrete form
\begin_inset Formula 
\[
\frac{N_{i}^{n+1}-N_{i}^{n}}{\Delta t}=\kappa\frac{N_{i+1}^{n}-2N_{i}^{n}+N_{i-1}^{n}}{\Delta x^{2}}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Stability of the discrete diffusion equation
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
By rearranging the numerical solution of the diffusion equation we get another
 non-dimensional number 
\begin_inset Formula 
\[
N_{i}^{n+1}=N_{i}^{n}+\kappa\frac{\Delta t}{\Delta x^{2}}\left(N_{i+1}^{n}-2N_{i}^{n}+N_{i-1}^{n}\right)
\]

\end_inset


\begin_inset Formula 
\[
D=\kappa\frac{\Delta t}{\Delta x^{2}}=\frac{\kappa}{\Delta x^{2}/\Delta t}
\]

\end_inset

which is the ratio between the diffusivity of the real problem and what
 we may call the 
\begin_inset Quotes eld
\end_inset

diffusivity
\begin_inset Quotes erd
\end_inset

 of the discrete numerical scheme.
 This condition is actually less restrictive than the Courant number derived
 in the advection equation that must be close to 0 for stability.
 It can be demonstrated using the 
\emph on
von Neumann stability analysis
\emph default
 that 
\begin_inset Formula $D\leq1/2$
\end_inset

 for conditional stability.
 But now that 
\begin_inset Formula $\Delta x$
\end_inset

 is to the power of 2, it is much more tricky to maintain stability if we
 aim at high spatial resolution.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size footnotesize
The numerical solution is similar to Ex.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{ex:advection}
\end_layout

\end_inset

 implemented in the notebook 
\family typewriter
diffusion.ipynb
\family default
.
 Familiarize yourself with the code and answer the following questions:
\end_layout

\begin_layout Enumerate

\size footnotesize
Study the numerical solution.
 Why does the flattening of the peak slow down with time? 
\end_layout

\begin_layout Enumerate

\size footnotesize
Look for the comment 
\family typewriter
#Question 2
\family default
 in the code.
 This is a different type of boundary conditions called 
\emph on
Neumann conditions
\emph default
 (not to be mistaken with 
\emph on
von Neumann
\emph default
).
 How would you describe them? Make a copy of the notebook (File|Make a copy)
 and change the boundary conditions to the ones used in the advection equation
 (
\emph on
Dirichlet boundary conditions
\emph default
, where the value at the boundary is prescribed).
 Run this code and compare it with the original: why do you think the Neumann
 boundary conditions are more realistic?
\end_layout

\begin_layout Enumerate

\size footnotesize
Make another copy of the notebook to play with the parameters.
 The grid parameters determine the stability of the numerical solution and
 its evolution, based on the physical parameters.
 In this case, the key parameter is the eddy diffusivity coefficient, which
 indicates the turbulence of the fluid and how quickly it dissipates the
 signal.
 What happens if you double the diffusivity coefficient? [you can adjust
 the y-axis limits to see the behaviour better].
 What would you do to fix it and why?
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Subsection
The Ekman layer model
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Reminder: the Ekman layer
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
7 cm
\end_layout

\begin_layout Itemize

\size footnotesize
Ekman studied the balance of forces in the upper layer by making some major
 assumptions on the horizontal Navier-Stokes (Boussinesq) equations
\size default

\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size scriptsize
homogeneous density
\end_layout

\begin_layout Itemize

\size scriptsize
the surface ocean is in steady state
\end_layout

\begin_layout Itemize

\size scriptsize
the velocity field only changes in the vertical and the vertical eddy viscosity
 
\begin_inset Formula $A_{v}$
\end_inset

 is constant
\end_layout

\begin_layout Itemize

\size scriptsize
there is no horizontal pressure gradient
\end_layout

\begin_layout Itemize

\size scriptsize
the momentum flux at the surface is equal to the wind stress 
\begin_inset Formula $\left(A_{v}\frac{\partial u}{\partial z}\right)_{z=0}=\frac{\tau_{x}}{\rho_{0}}$
\end_inset

; 
\begin_inset Formula $\left(A_{v}\frac{\partial v}{\partial z}\right)_{z=0}=\frac{\tau_{y}}{\rho_{0}}$
\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
the momentum flux at a certain depth 
\begin_inset Formula $-\delta$
\end_inset

 is zero, 
\begin_inset Formula $\left(A_{v}\frac{\partial u}{\partial z}\right)_{z=-\delta}=\left(A_{v}\frac{\partial v}{\partial z}\right)_{z=-\delta}=0$
\end_inset


\end_layout

\end_deeper
\begin_layout Column
5.5 cm
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset VSpace -1cm
\end_inset


\begin_inset Formula 
\[
\frac{D\vec{u}_{H}}{Dt}=-\frac{\nabla p}{\rho_{0}}-f\left(\hat{k}\times\vec{u}_{H}\right)+A_{v}\nabla^{2}\vec{u}_{H}
\]

\end_inset


\size default

\begin_inset Graphics
	filename figures/f10-04-P558691.jpg
	lyxscale 50
	width 4cm

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
The resulting equation describes a special velocity field 
\begin_inset Formula $\vec{u}_{E}$
\end_inset

 that balances the Coriolis acceleration with the frictional acceleration
 
\begin_inset Formula 
\[
f\hat{k}\times\vec{u_{E}}=A_{v}\frac{\partial^{2}\vec{u}_{E}}{\partial z^{2}}
\]

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The Ekman velocity profile
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6 cm
\end_layout

\begin_layout Itemize

\size small
The resulting equation describes a velocity field that balance the Coriolis
 acceleration with the (turbulent) frictional acceleration 
\begin_inset Formula 
\[
f\hat{k}\times\vec{u_{E}}=A_{V}\frac{\partial^{2}\vec{u}_{E}}{\partial z^{2}}
\]

\end_inset


\end_layout

\begin_layout Itemize

\size small
It shows how the velocity changes with depth in the Ekman layer and it can
 be written as an ODE system, since there is only one independent variable
 
\begin_inset Formula $z$
\end_inset


\begin_inset VSpace -0.4cm
\end_inset


\begin_inset Formula 
\begin{eqnarray*}
-fv_{E} & = & A_{V}u_{E}''\\
fu_{E} & = & A_{V}v_{E}''
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Column
6 cm
\end_layout

\begin_layout Standard

\size small
This system has an analytical solution that was proposed by Ekman (a combination
 of exponential and trig functions) that describe the shape of the Ekman
 spiral
\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset Graphics
	filename figures/f10-05-P558691.jpg
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Reminder: Ekman transport
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\begin_layout Itemize

\size scriptsize
The Ekman transport is the vertical integral of the velocity in the Ekman
 layer (
\emph on
remind yourself of the units
\emph default
)
\begin_inset Formula 
\[
M_{E}^{(y)}=\int_{D_{E}}v_{E}(z)dz;\ M_{E}^{(x)}=\int_{D_{E}}u_{E}(z)dz
\]

\end_inset


\end_layout

\begin_layout Itemize

\size scriptsize
Using the boundary conditions above, we can demonstrate that is proportional
 to the wind stress and exactly perpendicular to the right (left) of the
 wind in the Northern (Southern) hemisphere because the sign is given by
 the Coriolis parameter
\begin_inset VSpace -0.4cm
\end_inset


\begin_inset Formula 
\begin{eqnarray*}
f\hat{k}\times\intop_{0}^{-\delta}\vec{u_{E}}dz & = & A_{v}\intop_{0}^{-\delta}\frac{\partial^{2}\vec{u_{E}}}{\partial z^{2}}dz\\
f\hat{k}\times\vec{M}_{E} & = & \frac{\vec{\tau_{W}}}{\rho_{0}}
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
M_{E}^{(x)}=\frac{\tau_{W}^{(y)}}{\rho_{0}f};\ M_{E}^{(y)}=-\frac{\tau_{W}^{(x)}}{\rho_{0}f}
\]

\end_inset


\end_layout

\begin_layout Column
5cm
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/ekman_transport.jpeg
	lyxscale 50
	width 3cm

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename figures/ekman_transport_South.png
	lyxscale 30
	width 4cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The numerics of the dynamical Ekman layer
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6 cm
\end_layout

\begin_layout Itemize

\size small
The equations for the Ekman velocity represent a system of diffusion PDEs,
 one for 
\begin_inset Formula $u_{E}(z,t)$
\end_inset

 and one for 
\begin_inset Formula $v_{E}(z,t)$
\end_inset

, with the 
\series bold
addition of a source term
\series default
 due to the Coriolis acceleration.
 Numerically, we can solve the full set of dynamical equations, not just
 the steady state
\begin_inset Formula 
\begin{align}
\frac{\partial u_{E}}{\partial t}-fv_{E}= & A_{v}\frac{\partial^{2}u_{E}}{\partial z^{2}}\label{eq:dynamical-ekman}\\
\frac{\partial v_{E}}{\partial t}+fu_{E}= & A_{v}\frac{\partial^{2}v_{E}}{\partial z^{2}}\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Column
6 cm
\end_layout

\begin_layout Standard

\size small
The vertical grid starts at the surface with 
\begin_inset Formula $z_{0}=0$
\end_inset

 and 
\begin_inset Formula $z_{k}=z_{0}-k\Delta z$
\end_inset

; time is discretized with 
\begin_inset Formula $t_{i}=t_{0}+n\Delta t$
\end_inset

.
 We seek for the solutions 
\begin_inset Formula $u_{k}^{n}$
\end_inset

 and 
\begin_inset Formula $v_{k}^{n}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset Graphics
	filename figures/ekman-grid.png
	width 4cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Exercise 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
exercise{ex:ekman-discrete}
\end_layout

\end_inset

: the discretized Ekman equations
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Write the discretized form of the equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dynamical-ekman"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the zonal and meridional components using the grid shown in the previous
 slide.
\end_layout

\begin_layout Enumerate
Derive the non-dimensional Courant number that depends on the vertical viscosity
\end_layout

\begin_layout Enumerate
Using the vertical eddy viscosity shown 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fr:eddy-viscosity-diffusivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

, what would be your choice of 
\begin_inset Formula $\Delta z$
\end_inset

 and 
\begin_inset Formula $\Delta t$
\end_inset

 to ensure stability? 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Collaborative project: code porting and writing 
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\size scriptsize
In ocean modelling, as in any other discipline that relies on scientific
 computing, it makes sense to reuse code produced by others and make it
 your own.
 However, people use different types of computer languages and you will
 often have to 
\emph on
port
\emph default
 (translate) the code in another language
\end_layout

\begin_layout Itemize

\size scriptsize
Working in a team is the best way to learn coding, since you will have to
 confront each other on the best way to write the various parts and whether
 it is understandable and/or efficient (there is often more than one way).
 You do not need to create a very efficient code, but the whole team needs
 to understand how it works.
\end_layout

\begin_layout Itemize

\size scriptsize
Your collaborative project will be the porting of a MATLAB code that solves
 the Ekman equation in python.
 The code is available in the file ekman_spiral.m.
 A good reference for comparing numpy and MATLAB commands is 
\begin_inset CommandInset href
LatexCommand href
name "http://mathesaurus.sourceforge.net/matlab-numpy.html"
target "http://mathesaurus.sourceforge.net/matlab-numpy.html"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize

\size scriptsize
You will decide how to 
\end_layout

\begin_deeper
\begin_layout Itemize

\size scriptsize
manage your team (nominate a team leader(s), create groups of software designers
 and programmers, etc...)
\end_layout

\begin_layout Itemize

\size scriptsize
design and produce the software (which IDE to use, create a notebook or
 not, how to handle different versions, etc...)
\end_layout

\begin_layout Itemize

\size scriptsize
present the results (choose the colors and the attributes of the figures,
 create an animation or a series of static figures, decide the main example
 for the user, etc.)
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
\size scriptsize
The final deliverable will be the python code and a brief presentation showing
 how to use the code and what it produces
\end_layout

\end_deeper
\begin_layout Frame

\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
The MATLAB code output in the Northern Hemisphere
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Graphics
	filename figures/ekman-matlab-1.png
	lyxscale 20
	width 5cm

\end_inset


\begin_inset Graphics
	filename figures/ekman-matlab-2.png
	lyxscale 20
	width 6cm

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Section
Ocean models
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
What is an Ocean Model?
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/r58_9_cube_mercator_4.jpg
	lyxscale 50
	scale 26

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Source: 
\color blue

\begin_inset Formula $http://www.mercator-ocean.fr/fre/mercator-ocean/$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Some oceanic physical processes: 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Ocean circulation (Thermohaline, gyres, currents, jets, filaments,...)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Turbulence, geostrophic eddies
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Waves (Tsunamis, Kelvin waves, Rossby waves, Gravity waves, internal waves,
 ..etc)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Tides
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Upwelling and Downwelling
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Transport (Mass, Volume and Energy)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Mixing (Lateral and vertical), stirring, diffusion 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Some oceanic physical processes: 
\color red
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/ocean_processes_nasa.jpg
	lyxscale 60
	scale 25

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
http://www.gfdl.noaa.gov/oceanmodelsatgfdl.
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Some oceanic biogeochemical processes
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Phytoplankton blooms
\end_layout

\begin_layout Itemize
Harmful algal blooms
\end_layout

\begin_layout Itemize
Hypoxia and anoxia
\end_layout

\begin_layout Itemize
Nutrient upwelling
\end_layout

\begin_layout Itemize
(Green House) Gas exchange at the air-sea interface
\end_layout

\begin_layout Itemize
Deep water ventilation
\end_layout

\begin_layout Itemize
Organic material transfer through the food web and export
\end_layout

\begin_layout Itemize
Ocean carbon cycle
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Some oceanic biogeochemical processes
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/ocean_carbon_cycle.jpg
	lyxscale 60
	scale 25

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Chisolm, Nature 407, 685-687 (2000) doi:10.1038/35037696
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Scales and processes
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
Models cannot simulate all possible scales and choices must be made to ensure
 sufficient realism while preserving feasibility
\end_layout

\begin_layout Itemize
Everything smaller than your grid scale must be parameterized (sub-grid
 scale)
\end_layout

\begin_layout Itemize
The parameterizations assumptions and the modeled spatial and temporal scales
 are the first things to be decided
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/scales_glover.png
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Some oceanic processes, and their 
\color red
Characteristic Scales
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/figure_length_timescales.jpg
	lyxscale 20
	scale 15

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout

\color red
Source: pord.ucsd.edu
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Scales and models
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/scales_dickey.png
	lyxscale 50
	scale 40

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Use of numerical models
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Some Advantages:
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Desirable spatial and temporal coverage.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Regular sampling of the variables.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Synoptic information of a wider-range of the oceanic parameters throughout
 the ocean column (it allows better understanding).
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Why use numerical models?
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Some Advantages:
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\color black
Allows to diagnose specific process 
\color blue
(e.g: Particular form of instability, or role of friction under particular
 conditions, species dominance under upwelling conditions, etc)
\end_layout

\begin_layout Itemize

\color black
Allows to test hypothesis 
\color blue
(e.g: what if, removal of components or processes, etc)
\color inherit
.
\end_layout

\begin_layout Itemize
Allows to reconstruct the past (
\color red
hindcast
\color inherit
), fill in gaps in ebservations (
\color red
nowcast
\color inherit
), make short term predictions (
\color red
forecast
\color inherit
) or long term predictions (scenarios)
\color blue
.

\color inherit
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Applications of Ocean Models around Southern Africa
\end_layout

\begin_layout Itemize

\size footnotesize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Allows to diagnose specific processes (e.g: Warming of the Agulhas Current
 since 1980, due to the augmentation of the transport in response to the
 increased wind stress curl)., Rouault et al.
 2009
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\size footnotesize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Allows to test hypothesis, perform idealized experiments (e.g: No Agulhas
 Current (Chang et al., 2008; Veitch et al.
 2009)., No Madagascar (Penven et al.
 2006).
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/noagulhas.png
	scale 14

\end_inset


\begin_inset VSpace -1cm
\end_inset


\begin_inset Graphics
	filename figures/pace2.png
	scale 50

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Numerical models
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Some Challenges:
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

The numerical equations driving the model are 
\color red
approximations
\color inherit
 to the continuous analytic equations that describe fluid flow.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Models contain no information about flow between grid points (descrete informati
on)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

.
 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color black
Furthermore, Not every process in the ocean is understood and represented
 by a mathematical formulation.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color black
Parametrizations of Subgrid-scale processes (Unresolved processes).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color black
Numerical errors (e.g: Truncation and rounding numbers).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color red
Model results are NOT REALITY! 
\color inherit
 (Just good approx of reality)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\color red
HISTORY OF OCEAN MODELS
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

First Oceanic General Circulation Model (OGCM) is credited to Kirk Bryan
 at GFDL (late 1960's).
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Special efforts on the evolution of this model type by Mike Cox 
\begin_inset Formula $\&$
\end_inset

 Bert Semtner (mid 1970's).
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

  
\end_layout

\begin_layout Itemize

\color blue
Global Z - Verical coordinate model.
\end_layout

\begin_layout Itemize

\color blue
Low-order numerics with finite difference schemes.

\color inherit
 
\end_layout

\begin_layout Itemize
Competing approaches to vertical discretization and coordinate treatment
 (
\color blue
"Layered
\color inherit
" [immiscible layers] and "
\color blue
Sigma"
\color inherit
 models) emerges (during 1970's).
 
\begin_inset Formula $\textit{\textcolor{blue}{details of these models to be given latter!}}$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Ocean Models: 
\color blue
Evolution of an Ocean Model
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/model_genealogy.png
	scale 30

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout

\color blue
http://climate.lanl.gov/Models/POP/download
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle

\color red
Why so many different models?
\color inherit
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
 
\begin_inset Graphics
	filename figures/ocean_models.png
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Classification of Ocean Models
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Models are classified according to the different approaches used to represent
 the 
\color red
Horizontal grid
\color inherit
 and the 
\color red
Vertical coordinate system
\color inherit
.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/climateSystem2.png
	scale 35

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Main Criteria of Classification
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Geography
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Physical process
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Surface approximation
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Density variation
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Discretization of the vertical coordinate 
\begin_inset Newline newline
\end_inset

 
\color blue
(Representation of the vertical structure of oceanic water column)
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Geographic classification: 
\color blue
Domain size
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Global-scale
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Basin-scale
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Regional or local-scale
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/globalgrid.png
	scale 25

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout

\color blue
Backeberg et al., 2009
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Surface approximation 
\color blue
(representation of the sea surface)
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
All finite difference numerical models are constrained by the timestep.
 
\color red
Advective
\color inherit
 and 
\color red
wave-like processes
\color inherit
 must not move more than one grid point per timestep (
\color red
Courant-Friedrichs-Levy (CFL) criterion
\color inherit
).
 Surface processes are the fastest
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Rigid-Lid models
\series default
\color inherit
 (Ocean-atmosphere interface doesn't evolve) To avoid severe limitations
 on the time-steps due to fast gravity waves (surface gravity waves are
 neglected from the system, and retaining only the horizontal pressure gradient
 due to the large-scale circulation.
\end_layout

\begin_layout Itemize

\series bold
\color blue
Free-Surface models:
\series default
\color inherit
 The height of the free-surface (SSH) is driven up or down by convergence/diverg
ence of the fluid throughout the underlying water column.
 Slow modes and fast modes are treated separately.
\end_layout

\begin_layout Itemize

\series bold
\color blue
Implicit surface models:
\series default
\color inherit
 A smoothed solution of the surface that retains the influence of the faster
 waves
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Rigid-Lid approximations
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Advantages:
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

With less constraint on the permissible timesteps, it was possible to use
 steps of order several hours and a very coarse resolution.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
Disadvantages:
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

It increases the surface wave speed to infinity, and modifies certain other
 long-wave dynamics (e.g: Barotropic Rossby or Planetary waves).
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Barotropic flow had not been removed, rather it had been modified!
\color inherit
 So to calculate it, a two-dimensional stream function had to be calculated.
 In case of large domains, finer grids, complicated bottom topography and
 varying coastlines the computation was too expensive.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Surface approximation
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout
In reality the ocean surface is free to deform, under the influence of winds,
 heating, and tidal forces.
 It has fast moving and short-lived waves.
 
\color red
These needs to be retained!
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

 A prognostic equation for free surface height (SSH) is obtained by integrating
 the non-divergent continuity equation in the vertical from the bottom 
\begin_inset Formula $z$
\end_inset

=
\begin_inset Formula $-H(x,y)$
\end_inset

, to the top at 
\begin_inset Formula $z$
\end_inset

=
\begin_inset Formula $\eta$
\end_inset

(x,y,t):
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\eta=\int_{-H}^{\eta}{\frac{\partial{w}}{\partial z}dz}=-\int_{-H}^{\eta}\nabla_{h}.{\vec{v}}dz
\end{equation}

\end_inset


\begin_inset VSpace 0.2in
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Density variation
\end_layout

\begin_layout Standard
In general ocean models describe the response of a variable density ocean
 to atmospheric momentum and heat forcing (such response can be represented
 by 
\color red
Barotropic and Baroclinic modes.
\color inherit
)
\begin_inset Newline newline
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color red
Barotropic models:
\color inherit
 The ocean's water column is vertically integrated to obtain one value for
 vertically different horizontal currents.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color red
Baroclinic models:
\color inherit
 The ocean's column has variable horizontal flows with depth.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/barotropic_model.png
	scale 25

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Vertical discretization
\end_layout

\begin_layout Standard
There are several choices for a vertical coordinate system used to represent
 the vertical structure of the ocean's water column.
\begin_inset Newline newline
\end_inset

 All choices allows to increase detail near the surface where most of the
 action occurs.
 
\color red
However, all have their strong and weak points!
\color inherit

\begin_inset Newline newline
\end_inset

 
\begin_inset VSpace 0.2in
\end_inset

 The 4-most used coordinates are:
\end_layout

\begin_layout Standard
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Fixed-Level, Geopotential or Z-Coordinate model
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Isopycnal-coordinate model
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Sigma or Stretched-coordinate model
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Hybrid-coordinate model
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset VSpace 0.1in
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Vertical coordinates (J.
 Durgadoo lecture)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/vertical-coordinates.png
	lyxscale 30
	width 80page%

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Z-Coordinate
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Consist on a series of regular surface depths.
\begin_inset Newline newline
\end_inset

 
\color blue
It is easy to set-up and is computationally efficient.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.12in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
The resolution is increased by decreasing the spacing between the levels.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.12in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
There is no easy-way to add grid cells without adding on the entire model
 domain.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.12in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
It has a poor representation of the continental slope.
\begin_inset Newline newline
\end_inset

 (Problems with flow over topography)
\color inherit
.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Z-Coordinate
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
 
\begin_inset Graphics
	filename figures/z-coord.jpg
	scale 90

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Isopycnal-Coordinate
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Envisions the ocean as being made-up of a set of non-mixing layers whose
 interface locations adjust in time as part of the dynamics.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

The equations of motion are vertically integreted between isopycnals (surface
 of equal density).
 The layer-averaged velocities and layer ticknesses are dependent variables.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
The main advantage is that Mixing across the layers can be neglected (simplifyin
g some computations and complexities).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
 It has a very good representation of a stratified ocean 
\begin_inset Newline newline
\end_inset

(e.g: thermocline).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
 The main disadvantage is that these models perform poorly in shallow waters
 where the ocean is less stratified.
 
\begin_inset Newline newline
\end_inset

(It is not good for shelf dynamics).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Isopycnal-Coordinate
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/isopyc-coord.png
	scale 90

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Sigma-Coordinate
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

It assumes coordinate surfaces which are fixed in time, but follow the underlyin
g topography (are therefore not geopotential surfaces for non-flat bethymetry).
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Handles well the lateral boundaries and complex bathymetry.
 Are fairly horizontal near the ocean surface, and mimic the bathymetry
 near the seafloor (e.g: ROMS).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
It allows a better representation of the flow over the bathymetry.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Can cause instabilities where the topography is very steep.
 Pressure gradient errors.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Sigma-Coordinate
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/sig-coord.png
	scale 35

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Hybrid-Coordinate
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color black
Seeks to optimize model performance by combining the best coordinate systems
 in different regions, based on the dominant process at work.
 (e.g: HYCOM uses Z, Iso, sigma- coordinates).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
It has a good representation of the vertical structure of the ocean throughout
 the water column.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
It allows the vertical coordinates to evolve in time and space as the depth
 of the mixed layer changes.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
It has a high computational cost.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Hybrid-Coordinate
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2.5in
\end_inset

 
\begin_inset Graphics
	filename figures/hyb-coord.jpg
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
\begin_inset space \hspace{}
\length 1in
\end_inset

Horizontal grid discretization
\end_layout

\begin_layout Standard
To apply the mathematical formulation to a model ocean it is required to
 convert the equations to a series of algorithms that can be numerically
 applied to a digitized gridded ocean.
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Regular horizontal grids
\color inherit
 (Structured)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Irregular horizontal grids
\color inherit
 (Unstructured)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/regular_irregular_grids.jpg
	scale 25

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Horizontal grids
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout

\color red
Structured Grids
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

 (Rectangular, Curvilinear and Spherical)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_inset

Consist of a series of equally spaced lines.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace 0.1in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Are computationally efficient.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Uses straight forward algorithms.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset VSpace 0.15in
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Because the surface of the earth is a sphere, we can not truly apply a uniform
 spacing across the grid and keep the lines straight
\begin_inset Newline newline
\end_inset

 
\color red
(problems at the poles).
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Grids on the Earth surface
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Graphics
	filename figures/spherical.png
	lyxscale 50
	width 80page%

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Spherical Earth grid and singularities
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsCenterAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/ORCA2_Mesh_grey_sphere.jpg
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\begin_layout Column
7cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/ORCA2_north_pole_mesh.pdf
	lyxscale 50
	width 7cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Data on the i,j (matrix) grid
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsCenterAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/ORCA2-SST.png
	lyxscale 30
	width 6cm

\end_inset


\end_layout

\begin_layout Column
7cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/GFDL-SST.png
	lyxscale 30
	width 7cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Curvilinear coordinates (Madec, NEMO book)
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size scriptsize
Let 
\begin_inset Formula $(i,j,k)$
\end_inset

 be a set of orthogonal curvilinear coordinates on the sphere associated
 with the positively oriented orthogonal set of unit vectors 
\begin_inset Formula $(\hat{\mathbf{i}},\mathbf{\hat{j}},\hat{\mathbf{k}})$
\end_inset

 linked to the earth such that 
\begin_inset Formula $\hat{\mathbf{k}}$
\end_inset

 is the local upward vector and 
\begin_inset Formula $(\hat{\mathbf{i}},\mathbf{\hat{j}})$
\end_inset

 are two vectors orthogonal to 
\begin_inset Formula $\hat{\mathbf{k}}$
\end_inset

, i.e.
 along geopotential surfaces.
 Let 
\begin_inset Formula $(\lambda,\varphi,z)$
\end_inset

 be the geographical coordinate system in which a position is defined by
 the latitude 
\begin_inset Formula $\varphi(i,j)$
\end_inset

, the longitude 
\begin_inset Formula $λ(i,j)$
\end_inset

 and the distance from the centre of the earth a + z(k) where 
\begin_inset Formula $a$
\end_inset

 is the earth’s radius and z the altitude above a reference sea level (in
 some cases we apply the thin shell approximation: 
\begin_inset Formula $a+z\approxeq a$
\end_inset

).
 The local deformation of the curvilinear coordinate system is given by
 
\begin_inset Formula $(e1,e2,e3$
\end_inset

), the three scale factors:
\end_layout

\begin_layout ColumnsCenterAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\[
\begin{aligned}e_{1} & =\left({a+z}\right)\;\left[{\left({\frac{\partial\lambda}{\partial i}\cos\varphi}\right)^{2}+\left({\frac{\partial\varphi}{\partial i}}\right)^{2}}\right]^{1/2}\\
e_{2} & =\left({a+z}\right)\;\left[{\left({\frac{\partial\lambda}{\partial j}\cos\varphi}\right)^{2}+\left({\frac{\partial\varphi}{\partial j}}\right)^{2}}\right]^{1/2}\\
e_{3} & =\left({\frac{\partial z}{\partial k}}\right)
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/curvilinear-coordinates-nemo.png
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Vector-invariant operators
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\size small
All the vector operators can thus be written in terms of the new coordinate
 system.
 Given a scalar field 
\begin_inset Formula $q(i,j,k)$
\end_inset

 and vector 
\begin_inset Formula $\mathbf{A}\equiv(a_{1},a_{2},a_{3})$
\end_inset

, these are invariant for any scale deformation
\begin_inset Formula 
\[
\nabla q=\frac{1}{e_{1}}\frac{\partial q}{\partial i}\;{\rm {\bf i}}+\frac{1}{e_{2}}\frac{\partial q}{\partial j}\;{\rm {\bf j}}+\frac{1}{e_{3}}\frac{\partial q}{\partial k}\;{\rm {\bf k}}
\]

\end_inset


\begin_inset Formula 
\[
\nabla\cdot{\rm {\bf A}}=\frac{1}{e_{1}\;e_{2}}\left[\frac{\partial\left(e_{2}\;a_{1}\right)}{\partial i}+\frac{\partial\left(e_{1}\;a_{2}\right)}{\partial j}\right]+\frac{1}{e_{3}}\left[\frac{\partial a_{3}}{\partial k}\right]
\]

\end_inset


\begin_inset Formula 
\[
\nabla\times\mathbf{A}=\left[{\frac{1}{e_{2}}\frac{\partial a_{3}}{\partial j}-\frac{1}{e_{3}}\frac{\partial a_{2}}{\partial k}}\right]\;\mathbf{i}+\left[{\frac{1}{e_{3}}\frac{\partial a_{1}}{\partial k}-\frac{1}{e_{1}}\frac{\partial a_{3}}{\partial i}}\right]\;\mathbf{j}+\frac{1}{e_{1}e_{2}}\left[{\frac{\partial\left({e_{2}a_{2}}\right)}{\partial i}-\frac{\partial\left({e_{1}a_{1}}\right)}{\partial j}}\right]\;\mathbf{k}
\]

\end_inset


\size default
 
\end_layout

\end_deeper
\begin_layout Frame

\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Structured grid types (staggering)
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/grid_types.png
	scale 50

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\color blue
Differences associated with the placement of the variables in the grid cells
 (Arakawa A, B, C, D).

\color inherit
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Arrangement of variables on the NEMO
\begin_inset space \space{}
\end_inset

C grid
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula $T$
\end_inset

 indicates scalar points where temperature, salinity, density, pressure
 and horizontal divergence are defined.
 
\begin_inset Formula $(u,v,w)$
\end_inset

 indicates vector points, and 
\begin_inset Formula $f$
\end_inset

 indicates vorticity points where both relative and planetary vorticities
 are defined
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/Cgrid-nemo.png
	lyxscale 50
	width 60page%

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Horizontal grids
\end_layout

\begin_layout Block
\begin_inset Argument 2
status collapsed

\begin_layout Plain Layout

\color red
Unstructured Grids
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

 (Triangular)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_inset

Consist of a series of triangles.
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Developed specially for Coastal ocean and estuarine processes.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Allows to increase the resolution near the coast where small-scale processes
 are important, while keeping coarse resolution where not required.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Can be difficult to set-up.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\color blue
Computationally expensive.
\color inherit

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
frame{
\end_layout

\end_inset


\end_layout

\begin_layout FrameTitle
Irregular grid models (global ocean example)
\end_layout

\begin_layout Standard
\begin_inset VSpace 0.1in
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/unstructured_grid.png
	lyxscale 50
	scale 30

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
